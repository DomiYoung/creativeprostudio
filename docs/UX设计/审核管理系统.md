# 审核管理系统 (Review Management) - UX 文档

## 系统概述

审核管理系统是批量处理中心的关键组成部分，为批量处理项目提供完整的审批工作流程。该系统实现了与飞书等第三方平台的集成，支持多角色协作的审核流程，确保批量处理操作在执行前得到适当的审核和批准。设计遵循 Apple Human Interface Guidelines，注重直观性和高效率。

## 信息架构

### 主要区域划分
- **审核区域标题栏**：包含标题和主要操作按钮
- **审核过滤器**：筛选不同状态的审核请求
- **审核卡片列表**：以卡片形式展示审核请求
- **审核详情弹窗**：查看和处理单个审核的详细信息

### 审核状态分类
- **待审核**：新提交的审核请求，等待审核人处理
- **已通过**：审核已批准，批量处理可以执行
- **已驳回**：审核被拒绝，需要修改后重新提交
- **草稿**：尚未提交的审核请求（可选状态）

## UI 组件详解

### 1. 审核卡片组件

**设计原则**：
- 提供足够的上下文信息，便于快速决策
- 状态和紧急程度视觉上清晰区分
- 便捷的操作入口

**组件结构**：
```
.review-card {
  ├── .card-header        // 标题和状态徽章
  ├── .card-body          // 详细信息
  │   ├── .review-info    // 提交人、时间等基本信息
  │   ├── .review-content // 批量处理内容摘要
  │   ├── .feishu-status  // 飞书集成状态
  │   └── .review-comments // 评论区（如有）
  └── .card-footer        // 操作按钮：通过/驳回/查看
}
```

**视觉设计**：
- 待审核：橙色系，提示需要注意
- 已通过：绿色系，表示成功状态
- 已驳回：红色系，表示需要修改
- 卡片悬停效果增强交互感
- 紧急审核可使用特殊标记或突出显示

### 2. 评论系统组件

**设计原则**：
- 支持结构化讨论
- 清晰的时间顺序
- 作者信息明确

**组件结构**：
```
.review-comments {
  ├── .comments-list      // 评论列表
  │   └── .comment-item   // 单条评论
  │       ├── .author-info // 作者信息
  │       ├── .comment-time // 评论时间
  │       └── .comment-content // 评论内容
  └── .add-comment-form   // 添加评论表单
      ├── .comment-textarea // 评论输入框
      └── .form-actions   // 表单按钮
}
```

**交互设计**：
- 支持回复特定评论
- 表情反应（可选）
- 支持基本格式（加粗、链接等）
- 实时预览

### 3. 飞书集成状态组件

**设计原则**：
- 状态一目了然
- 集成过程透明
- 出错时提供操作建议

**组件结构**：
```
.feishu-status {
  ├── .status-icon        // 状态图标
  ├── .status-text        // 状态文本
  └── .action-button      // 状态相关操作（如重试）
}
```

**状态类型**：
- 待同步：尚未推送到飞书
- 已同步：已推送到飞书，等待审批
- 飞书已批准：飞书平台上已批准
- 飞书已拒绝：飞书平台上已拒绝
- 同步失败：同步过程中出错

### 4. 过滤器组件

**设计原则**：
- 简洁明了的分类
- 当前筛选状态明确
- 快速切换不同状态视图

**组件结构**：
```
.review-filters {
  ├── .filter-item        // 单个过滤选项
  │   ├── .filter-icon    // 过滤图标（可选）
  │   └── .filter-label   // 过滤标签
  └── .active-indicator   // 当前活动选项指示器
}
```

**视觉设计**：
- 圆角按钮组设计
- 活动状态使用填充背景色
- 非活动状态使用轻量设计

## 交互设计

### 主要交互流程

1. **提交审核流程**：
   - 从批量创建页面提交待审核请求
   - 填写审核相关信息
   - 可选择是否同步至飞书
   - 提交后显示成功确认

2. **审核处理流程**：
   - 审核者查看待审核列表
   - 打开特定审核查看详情
   - 添加评论或反馈意见
   - 批准或驳回请求
   - 状态自动同步至飞书（如已集成）

3. **修改重提流程**：
   - 查看被驳回的审核请求
   - 查看驳回原因和评论
   - 进行必要修改
   - 重新提交审核

4. **飞书同步流程**：
   - 点击"同步飞书审核"按钮
   - 系统连接飞书API
   - 获取最新审批状态
   - 更新本地审核状态

### 微交互细节

1. **状态转换动画**：
   - 状态变更时平滑过渡
   - 颜色和图标协调变化
   - 成功/失败反馈明确

2. **评论提交反馈**：
   - 提交按钮状态变化
   - 成功提交后平滑添加到列表
   - 错误状态明确提示

3. **飞书同步指示器**：
   - 同步过程中显示加载动画
   - 同步完成后提供成功反馈
   - 同步失败时提供明确错误信息

## 审核管理系统与飞书集成

### 集成架构

1. **数据同步模型**：
   - 双向同步：系统状态变更同步至飞书，飞书审批结果同步回系统
   - 定时同步：系统定期检查飞书审批状态
   - 手动同步：用户可手动触发同步

2. **审批流程映射**：
   - 系统审核状态映射到飞书审批流程
   - 飞书审批流程节点映射回系统状态
   - 支持多级审批流程

3. **错误处理**：
   - 同步失败时的重试机制
   - 状态不一致时的冲突解决策略
   - 降级模式：飞书不可用时的本地审批流程

### 用户权限与角色

1. **角色定义**：
   - 提交者：能够创建和提交审核请求
   - 审核者：能够批准或驳回审核
   - 管理员：能够配置审核流程和同步设置

2. **权限矩阵**：
   - 基于角色的访问控制
   - 特定审核类型的专属审核人
   - 紧急审核的特殊处理权限

## 响应式设计

- **断点适配**：
  - 桌面视图：卡片网格布局，多列展示
  - 平板视图：卡片以双列或单列展示
  - 移动视图：卡片单列布局，优化触摸操作

- **关键考量**：
  - 评论输入区域在移动端适当调整大小
  - 操作按钮在触屏设备上有足够大小
  - 状态指示器在各种屏幕尺寸上保持清晰可辨

## 可访问性考虑

- **屏幕阅读器支持**：
  - 审核卡片包含适当的ARIA角色和属性
  - 状态变化通过aria-live区域通知
  - 评论区支持键盘导航和操作

- **键盘可访问性**：
  - 所有交互元素可通过键盘操作
  - 焦点顺序合理且可预测
  - 提供键盘快捷键（附带说明）

- **颜色与对比度**：
  - 状态指示不仅依赖颜色，同时使用图标和文本
  - 所有文本元素符合WCAG AA对比度要求
  - 提供高对比度模式

## 用户体验流程图

```
提交审核请求
 │
 ↓
待审核状态 ──────→ 同步至飞书
 │                  │
 │                  ↓
 │               飞书审批流程
 │                  │
 ↓                  ↓
审核者审查 ←───── 飞书状态同步
 │
 ↓
添加评论（可选）
 │
 ↓
做出决定
 │
 ├─→ 批准 ───→ 更新状态为已通过 ───→ 同步至飞书 ───→ 执行批量处理
 │
 └─→ 驳回 ───→ 更新状态为已驳回 ───→ 同步至飞书 ───→ 返回修改
                                                    │
                                                    ↓
                                                修改后重新提交
```

## 设计决策说明

1. **卡片式设计的优势**：
   - 信息分组清晰，便于快速扫视和处理
   - 自然的容器边界，有助于区分不同审核请求
   - 适合响应式布局，能良好适应不同屏幕尺寸

2. **评论系统的重要性**：
   - 提供结构化沟通渠道，记录决策依据
   - 支持异步协作，提高团队效率
   - 保留审核历史，便于追溯和学习

3. **飞书集成的价值**：
   - 与企业现有工作流无缝衔接
   - 利用飞书通知机制提高响应速度
   - 统一审批入口，减少在多系统间切换

## 性能与可扩展性考虑

1. **列表性能优化**：
   - 虚拟滚动渲染大量审核卡片
   - 分页加载评论数据
   - 图片资源懒加载

2. **实时更新策略**：
   - WebSocket实现状态实时更新
   - 长轮询作为降级方案
   - 批量更新减少网络请求

3. **可扩展设计**：
   - 支持多种审核类型的扩展
   - 审核流程模板可定制
   - 预留与其他平台集成的接口 