<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>项目详情 - CreativePro Studio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* 设计变量 */
        :root {
            --dopamine-orange: #F5E1D9;
            --dopamine-pink: #FFB5C5;
            --dopamine-mint: #B6E5D8;
            --dopamine-blue: #97C1FF;
            --dopamine-purple: #D5B3FF;
            --dopamine-yellow: #FFE599;
            --gray-50: #F9FAFB;
            --gray-100: #F5F5F7;
            --gray-200: #E5E5E7;
            --gray-300: #D1D1D6;
            --gray-400: #A1A1A6;
            --gray-500: #86868B;
            --gray-600: #636366;
            --gray-700: #48484A;
            --gray-800: #3A3A3C;
            --gray-900: #1D1D1F;
        }

        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", Arial, sans-serif;
            background-color: var(--gray-100);
            color: var(--gray-900);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        button {
            border: none;
            background: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-700);
        }

        button:hover {
            color: var(--gray-900);
        }

        .btn {
            border-radius: 20px;
            padding: 0 16px;
            height: 36px;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--dopamine-orange);
            color: white;
        }

        .btn-primary:hover {
            background-color: #FF7E45;
            color: white;
        }

        .btn-outline {
            border: 1px solid var(--gray-300);
            background-color: white;
        }

        .btn-outline:hover {
            background-color: var(--gray-100);
        }

        .btn i {
            margin-right: 6px;
        }

        .container {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
            width: 100%;
        }

        /* 项目导航路径 */
        .breadcrumb {
            display: flex;
            align-items: center;
            font-size: 14px;
            margin-bottom: 24px;
        }
        
        .breadcrumb a {
            color: var(--gray-600);
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .breadcrumb a:hover {
            color: var(--dopamine-orange);
        }
        
        .breadcrumb i {
            margin: 0 8px;
            font-size: 12px;
            color: var(--gray-400);
        }

        /* 项目详情容器 */
        .project-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        /* 项目图片区域 */
        .project-preview {
            background-color: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .preview-title {
            font-size: 18px;
            font-weight: 600;
        }

        .preview-actions {
            display: flex;
            gap: 8px;
        }

        .preview-tool {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-700);
            background-color: var(--gray-100);
            transition: all 0.2s;
        }

        .preview-tool:hover {
            background-color: var(--gray-200);
            color: var(--gray-900);
        }

        .preview-image-container {
            flex: 1;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: center;
            background: repeating-conic-gradient(#f5f5f5 0% 25%, white 0% 50%) 
                        50% / 20px 20px;
        }

        .preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .preview-dimensions {
            position: absolute;
            bottom: 12px;
            right: 12px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            backdrop-filter: blur(4px);
        }

        .zoom-level {
            position: absolute;
            top: 12px;
            right: 12px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            backdrop-filter: blur(4px);
        }

        /* 项目信息区域 */
        .project-info {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .info-card {
            background-color: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .info-card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }

        .info-card-title i {
            margin-right: 8px;
            color: var(--dopamine-orange);
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-200);
            font-size: 14px;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: var(--gray-600);
        }

        .info-value {
            font-weight: 500;
            color: var(--gray-800);
        }

        .info-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 2px 8px;
            border-radius: 100px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-in-progress {
            background-color: rgba(255, 143, 94, 0.1);
            color: var(--dopamine-orange);
        }

        .badge-completed {
            background-color: rgba(182, 229, 216, 0.1);
            color: var(--dopamine-mint);
        }

        .badge-review {
            background-color: rgba(151, 193, 255, 0.1);
            color: var(--dopamine-blue);
        }

        .team-members {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .team-member {
            display: flex;
            align-items: center;
        }

        .member-avatar {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background-color: var(--dopamine-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-right: 12px;
        }

        .member-info {
            flex: 1;
        }

        .member-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .member-role {
            font-size: 12px;
            color: var(--gray-500);
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .badge-pending-review {
            background-color: rgba(255, 229, 153, 0.1);
            color: var(--dopamine-yellow);
        }

        .badge-approved {
            background-color: rgba(182, 229, 216, 0.1);
            color: var(--dopamine-mint);
        }

        .badge-rejected {
            background-color: rgba(255, 99, 71, 0.1);
            color: tomato;
        }

        .approval-flow {
            display: flex;
            align-items: center;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--gray-200);
        }

        .approval-step {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .approval-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 16px;
            right: -50%;
            width: 100%;
            height: 2px;
            background-color: var(--gray-300);
            z-index: 1;
        }

        .approval-step.completed:not(:last-child)::after {
            background-color: var(--dopamine-mint);
        }

        .approval-step.current:not(:last-child)::after {
            background-color: var(--dopamine-yellow);
        }

        .step-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--gray-200);
            color: var(--gray-500);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
        }

        .approval-step.completed .step-icon {
            background-color: var(--dopamine-mint);
            color: white;
        }

        .approval-step.current .step-icon {
            background-color: var(--dopamine-yellow);
            color: white;
        }

        .step-title {
            font-size: 12px;
            color: var(--gray-600);
            text-align: center;
        }

        .approval-step.completed .step-title {
            color: var(--dopamine-mint);
        }

        .approval-step.current .step-title {
            color: var(--dopamine-yellow);
            font-weight: 500;
        }

        .approval-buttons {
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }

        .approval-comment {
            margin-top: 16px;
        }

        .approval-comment textarea {
            width: 100%;
            height: 80px;
            padding: 8px;
            border: 1px solid var(--gray-300);
            border-radius: 4px;
            font-size: 13px;
            resize: none;
        }

        .history-item {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }

        .history-icon {
            width: 32px;
            height: 32px;
            border-radius: 16px;
            background-color: var(--gray-100);
            color: var(--gray-600);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .history-content {
            flex: 1;
            font-size: 14px;
        }

        .history-action {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .history-time {
            font-size: 12px;
            color: var(--gray-500);
        }

        .layers-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .layer-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 8px;
            background-color: var(--gray-100);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .layer-item:hover {
            background-color: var(--gray-200);
        }

        .layer-item.active {
            background-color: rgba(255, 143, 94, 0.1);
            color: var(--dopamine-orange);
        }

        .layer-visible {
            margin-right: 8px;
            color: var(--gray-700);
        }

        .layer-name {
            flex: 1;
        }

        .layer-type {
            font-size: 12px;
            color: var(--gray-500);
            padding: 2px 6px;
            border-radius: 4px;
            background-color: var(--gray-200);
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .project-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script src="navigation.js"></script>
</head>
<body>
    <!-- 导航栏由navigation.js自动添加 -->
    
    <div class="container">
        <div class="breadcrumb">
            <a href="welcome.html">
                <i class="fas fa-home"></i> 首页
            </a>
            <i class="fas fa-chevron-right"></i>
            <a href="project-group.html" id="groupLink">
                <span id="groupName">项目组</span>
            </a>
            <i class="fas fa-chevron-right"></i>
            <a href="#" class="current" id="projectTitle">项目详情</a>
        </div>
        
        <div class="project-container">
            <div class="project-preview">
                <div class="preview-header">
                    <h2 class="preview-title" id="previewTitle">项目名称</h2>
                    <div class="preview-actions">
                        <button class="preview-tool" title="缩小">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="preview-tool" title="放大">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="preview-tool" title="适应大小">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="preview-tool" title="全屏显示">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                    </div>
                </div>
                
                <div class="preview-image-container">
                    <img src="" alt="项目预览" class="preview-image" id="previewImage">
                    <div class="preview-dimensions" id="dimensions">800 × 800 px</div>
                    <div class="zoom-level">缩放: 100%</div>
                </div>
            </div>
            
            <div class="project-info">
                <div class="info-card action-buttons">
                    <button class="btn btn-primary" id="editProjectBtn">
                        <i class="fas fa-edit"></i> 编辑项目
                    </button>
                    <button class="btn btn-outline">
                        <i class="fas fa-share-alt"></i> 分享项目
                    </button>
                    <button class="btn btn-outline" id="submitForReviewBtn">
                        <i class="fas fa-check-circle"></i> 提交审批
                    </button>
                    <button class="btn btn-outline" id="viewHistoryBtn">
                        <i class="fas fa-history"></i> 历史版本
                    </button>
                </div>
                
                <div class="info-card">
                    <h3 class="info-card-title">
                        <i class="fas fa-info-circle"></i> 项目信息
                    </h3>
                    <div class="info-item">
                        <div class="info-label">项目ID</div>
                        <div class="info-value">PRJ-2025-0428</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">尺寸</div>
                        <div class="info-value" id="sizeDimensions">800 × 800 px</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">图层数</div>
                        <div class="info-value" id="layerCount">8个图层</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">创建日期</div>
                        <div class="info-value">2025-05-21</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">最后编辑</div>
                        <div class="info-value">今天 11:32</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">状态</div>
                        <div class="info-value">
                            <span class="info-badge badge-in-progress" id="statusBadge">进行中</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3 class="info-card-title">
                        <i class="fas fa-users"></i> 团队成员
                    </h3>
                    <div class="team-members" id="teamMembers">
                        <!-- 团队成员将通过JavaScript动态加载 -->
                    </div>
                </div>
                
                <div class="info-card">
                    <h3 class="info-card-title">
                        <i class="fas fa-layer-group"></i> 图层
                    </h3>
                    <div class="layers-list" id="layersList">
                        <!-- 图层列表将通过JavaScript动态加载 -->
                    </div>
                </div>
                
                <div class="info-card">
                    <h3 class="info-card-title">
                        <i class="fas fa-history"></i> 项目历史
                    </h3>
                    <div class="history-item">
                        <div class="history-icon">
                            <i class="fas fa-edit"></i>
                        </div>
                        <div class="history-content">
                            <div class="history-action">李运营修改了主图文本</div>
                            <div class="history-time">今天 11:32</div>
                        </div>
                    </div>
                    <div class="history-item">
                        <div class="history-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="history-content">
                            <div class="history-action">王设计添加了产品图层</div>
                            <div class="history-time">昨天 16:45</div>
                        </div>
                    </div>
                    <div class="history-item">
                        <div class="history-icon">
                            <i class="fas fa-plus"></i>
                        </div>
                        <div class="history-content">
                            <div class="history-action">项目创建</div>
                            <div class="history-time">2025-05-21 09:15</div>
                        </div>
                    </div>
                </div>
                
                <div class="info-card" id="approvalCard" style="display: none;">
                    <h3 class="info-card-title">
                        <i class="fas fa-clipboard-check"></i> 审批流程
                    </h3>
                    <div class="info-item">
                        <div class="info-label">审批状态</div>
                        <div class="info-value">
                            <span class="info-badge badge-pending-review" id="approvalStatusBadge">待审批</span>
                        </div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">审批人</div>
                        <div class="info-value" id="approverName">张产品经理</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">提交时间</div>
                        <div class="info-value" id="submitTime">2025-05-22 15:30</div>
                    </div>
                    
                    <!-- 审批流程可视化 -->
                    <div class="approval-flow">
                        <div class="approval-step completed">
                            <div class="step-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="step-title">设计</div>
                        </div>
                        <div class="approval-step current">
                            <div class="step-icon">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="step-title">审批</div>
                        </div>
                        <div class="approval-step">
                            <div class="step-icon">
                                <i class="fas fa-rocket"></i>
                            </div>
                            <div class="step-title">发布</div>
                        </div>
                    </div>
                    
                    <!-- 审批操作（只对审批人员显示） -->
                    <div class="approval-actions" id="approvalActions" style="display: none;">
                        <div class="approval-comment">
                            <textarea placeholder="请输入审批意见..."></textarea>
                        </div>
                        <div class="approval-buttons">
                            <button class="btn btn-primary" id="approveBtn">
                                <i class="fas fa-check"></i> 通过
                            </button>
                            <button class="btn btn-outline" style="color: tomato; border-color: tomato;" id="rejectBtn">
                                <i class="fas fa-times"></i> 驳回
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 获取URL参数
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('id');
            const groupId = urlParams.get('group');
            
            // 项目组数据映射
            const groupMapping = {
                '618': {
                    name: '618活动',
                    url: 'project-group.html?id=618'
                },
                'new-products': {
                    name: '新品上市',
                    url: 'project-group.html?id=new-products'
                },
                'potato-series': {
                    name: '土豆泥系列',
                    url: 'project-group.html?id=potato-series'
                },
                'brand-assets': {
                    name: '品牌资产',
                    url: 'project-group.html?id=brand-assets'
                }
            };
            
            // 项目数据映射 (通常这些数据会从服务器获取)
            const projectsData = {
                '618主会场Banner': {
                    image: 'https://images.pexels.com/photos/6621462/pexels-photo-6621462.jpeg',
                    dimensions: '1200 × 628 px',
                    layers: 12,
                    status: 'badge-in-progress',
                    statusText: '进行中',
                    members: [
                        { initial: 'D', name: 'Domi', role: '设计师', color: 'var(--dopamine-blue)' },
                        { initial: '李', name: '李运营', role: '市场运营', color: 'var(--dopamine-orange)' },
                        { initial: '王', name: '王设计', role: '资深设计师', color: 'var(--dopamine-pink)' }
                    ],
                    layersList: [
                        { name: '背景', type: '图片', visible: true },
                        { name: '产品图', type: '图片', visible: true },
                        { name: '标题文本', type: '文字', visible: true },
                        { name: '价格标签', type: '形状', visible: true },
                        { name: '促销标签', type: '形状', visible: true },
                        { name: '按钮', type: '形状', visible: true },
                        { name: '阴影效果', type: '效果', visible: false }
                    ]
                },
                '618限时秒杀': {
                    image: 'https://images.pexels.com/photos/5632402/pexels-photo-5632402.jpeg',
                    dimensions: '800 × 800 px',
                    layers: 8,
                    status: 'badge-review',
                    statusText: '审核中',
                    approvalData: {
                        status: 'pending-review',
                        statusText: '待审批',
                        approver: '张产品',
                        submitTime: '2023-05-22 15:30'
                    },
                    members: [
                        { initial: 'D', name: 'Domi', role: '设计师', color: 'var(--dopamine-blue)' },
                        { initial: '张', name: '张产品', role: '产品经理', color: 'var(--dopamine-purple)' }
                    ],
                    layersList: [
                        { name: '背景', type: '图片', visible: true },
                        { name: '产品组', type: '组', visible: true },
                        { name: '价格文本', type: '文字', visible: true },
                        { name: '秒杀标签', type: '形状', visible: true }
                    ]
                },
                '618品牌日封面': {
                    image: 'https://images.pexels.com/photos/5632398/pexels-photo-5632398.jpeg',
                    dimensions: '1080 × 1080 px',
                    layers: 10,
                    status: 'badge-in-progress',
                    statusText: '进行中',
                    members: [
                        { initial: 'D', name: 'Domi', role: '设计师', color: 'var(--dopamine-blue)' },
                        { initial: '李', name: '李运营', role: '市场运营', color: 'var(--dopamine-orange)' },
                        { initial: '赵', name: '赵美工', role: '美工', color: 'var(--dopamine-yellow)' }
                    ],
                    layersList: [
                        { name: '背景渐变', type: '图片', visible: true },
                        { name: '品牌元素', type: '组', visible: true },
                        { name: '标题文本', type: '文字', visible: true },
                        { name: '描述文本', type: '文字', visible: true },
                        { name: '促销信息', type: '组', visible: true }
                    ]
                },
                '618直播预告': {
                    image: 'https://images.pexels.com/photos/5632397/pexels-photo-5632397.jpeg',
                    dimensions: '1200 × 628 px',
                    layers: 6,
                    status: 'badge-completed',
                    statusText: '已完成',
                    members: [
                        { initial: 'D', name: 'Domi', role: '设计师', color: 'var(--dopamine-blue)' },
                        { initial: '王', name: '王设计', role: '资深设计师', color: 'var(--dopamine-pink)' }
                    ],
                    layersList: [
                        { name: '背景', type: '图片', visible: true },
                        { name: '主播头像', type: '图片', visible: true },
                        { name: '直播标题', type: '文字', visible: true },
                        { name: '时间信息', type: '文字', visible: true },
                        { name: '产品预览', type: '组', visible: true }
                    ]
                },
                '土豆泥卸妆膏': {
                    image: 'https://images.pexels.com/photos/4465125/pexels-photo-4465125.jpeg',
                    dimensions: '800 × 800 px',
                    layers: 8,
                    status: 'badge-in-progress',
                    statusText: '进行中',
                    members: [
                        { initial: 'D', name: 'Domi', role: '设计师', color: 'var(--dopamine-blue)' },
                        { initial: '李', name: '李运营', role: '市场运营', color: 'var(--dopamine-orange)' },
                        { initial: '王', name: '王设计', role: '资深设计师', color: 'var(--dopamine-pink)' }
                    ],
                    layersList: [
                        { name: '背景', type: '图片', visible: true },
                        { name: '产品主图', type: '图片', visible: true },
                        { name: '产品名称', type: '文字', visible: true },
                        { name: '产品描述', type: '文字', visible: true },
                        { name: '价格信息', type: '组', visible: true }
                    ]
                }
            };
            
            // 更新项目组信息
            if (groupId && groupMapping[groupId]) {
                document.getElementById('groupName').textContent = groupMapping[groupId].name;
                document.getElementById('groupLink').href = groupMapping[groupId].url;
            }
            
            // 更新项目信息
            if (projectId && projectsData[projectId]) {
                const projectData = projectsData[projectId];
                
                // 更新标题
                document.title = `${projectId} - CreativePro Studio`;
                document.getElementById('projectTitle').textContent = projectId;
                document.getElementById('previewTitle').textContent = projectId;
                
                // 更新预览图
                document.getElementById('previewImage').src = projectData.image;
                document.getElementById('previewImage').alt = projectId;
                
                // 更新尺寸信息
                document.getElementById('dimensions').textContent = projectData.dimensions;
                document.getElementById('sizeDimensions').textContent = projectData.dimensions;
                
                // 更新图层数
                document.getElementById('layerCount').textContent = `${projectData.layers}个图层`;
                
                // 更新状态
                const statusBadge = document.getElementById('statusBadge');
                statusBadge.className = `info-badge ${projectData.status}`;
                statusBadge.textContent = projectData.statusText;
                
                // 更新团队成员
                const teamMembersContainer = document.getElementById('teamMembers');
                teamMembersContainer.innerHTML = projectData.members.map(member => `
                    <div class="team-member">
                        <div class="member-avatar" style="background-color: ${member.color};">
                            ${member.initial}
                        </div>
                        <div class="member-info">
                            <div class="member-name">${member.name}</div>
                            <div class="member-role">${member.role}</div>
                        </div>
                    </div>
                `).join('');
                
                // 更新图层列表
                const layersListContainer = document.getElementById('layersList');
                layersListContainer.innerHTML = projectData.layersList.map((layer, index) => `
                    <div class="layer-item ${index === 0 ? 'active' : ''}">
                        <div class="layer-visible">
                            <i class="fas ${layer.visible ? 'fa-eye' : 'fa-eye-slash'}"></i>
                        </div>
                        <div class="layer-name">${layer.name}</div>
                        <div class="layer-type">${layer.type}</div>
                    </div>
                `).join('');
                
                // 处理审批流程
                setupApprovalProcess(projectData);
            }
            
            // 添加图层点击交互
            document.querySelectorAll('.layer-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.layer-item').forEach(layer => {
                        layer.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
            
            // 编辑项目按钮点击事件
            document.getElementById('editProjectBtn').addEventListener('click', function() {
                const returnUrl = `product-detail.html?id=${encodeURIComponent(projectId)}${groupId ? `&group=${encodeURIComponent(groupId)}` : ''}`;
                window.location.href = `canvas-editor.html?id=${encodeURIComponent(projectId)}&group=${encodeURIComponent(groupId || '')}`;
            });
            
            // 历史版本按钮点击事件
            document.getElementById('viewHistoryBtn').addEventListener('click', function() {
                // 在实际应用中，这里应该跳转到版本历史页面或打开版本历史弹窗
                alert('将显示项目的历史版本列表，包括每次审批前后的版本对比。\n\n在完整实现中，这里将展示项目不同时间点的版本，便于回溯设计变更和审批过程。');
            });
            
            // 设置审批流程
            function setupApprovalProcess(projectData) {
                const submitForReviewBtn = document.getElementById('submitForReviewBtn');
                const approvalCard = document.getElementById('approvalCard');
                const approvalStatusBadge = document.getElementById('approvalStatusBadge');
                const approvalActions = document.getElementById('approvalActions');
                
                // 根据项目状态显示/隐藏审批相关元素
                if (projectData.status === 'badge-review') {
                    // 项目正在审核中，显示审批卡片
                    approvalCard.style.display = 'block';
                    submitForReviewBtn.style.display = 'none';
                    
                    // 如果有审批数据，更新审批信息
                    if (projectData.approvalData) {
                        // 更新审批状态标签
                        approvalStatusBadge.textContent = projectData.approvalData.statusText;
                        
                        // 更新审批人
                        document.getElementById('approverName').textContent = projectData.approvalData.approver;
                        
                        // 更新提交时间
                        document.getElementById('submitTime').textContent = projectData.approvalData.submitTime;
                    }
                    
                    // 假设当前用户是审批人，显示审批操作区
                    const currentUser = 'D'; // 当前登录用户
                    const isApprover = projectData.members.some(member => 
                        member.role.includes('产品') && member.initial === currentUser
                    ); // 检查当前用户是否为审批人
                    
                    if (isApprover) {
                        approvalActions.style.display = 'block';
                    }
                    
                    // 添加审批按钮事件
                    document.getElementById('approveBtn').addEventListener('click', function() {
                        approveProject(projectData);
                    });
                    
                    document.getElementById('rejectBtn').addEventListener('click', function() {
                        rejectProject(projectData);
                    });
                    
                    // 禁用编辑按钮
                    document.getElementById('editProjectBtn').disabled = true;
                    document.getElementById('editProjectBtn').style.opacity = '0.5';
                } else {
                    // 项目未提交审核，显示提交审核按钮
                    approvalCard.style.display = 'none';
                    
                    // 如果项目已完成，隐藏提交审核按钮
                    if (projectData.status === 'badge-completed') {
                        submitForReviewBtn.style.display = 'none';
                    } else {
                        submitForReviewBtn.style.display = 'block';
                        
                        // 添加提交审核按钮点击事件
                        submitForReviewBtn.addEventListener('click', function() {
                            submitForReview(projectData);
                        });
                    }
                }
            }
            
            // 提交审核
            function submitForReview(projectData) {
                if (confirm('确定要提交该项目进行审批吗？提交后将无法编辑，直到审批完成。')) {
                    // 更新项目状态
                    const statusBadge = document.getElementById('statusBadge');
                    statusBadge.className = 'info-badge badge-review';
                    statusBadge.textContent = '审核中';
                    
                    // 显示审批卡片
                    document.getElementById('approvalCard').style.display = 'block';
                    document.getElementById('submitForReviewBtn').style.display = 'none';
                    
                    // 添加到历史记录
                    addHistoryItem('提交审批', 'fa-paper-plane');
                    
                    // 禁用编辑按钮
                    document.getElementById('editProjectBtn').disabled = true;
                    document.getElementById('editProjectBtn').style.opacity = '0.5';
                    
                    alert('项目已提交审批，等待审批人员审核');
                }
            }
            
            // 审批通过
            function approveProject(projectData) {
                if (confirm('确定要通过该项目吗？')) {
                    // 更新审批状态
                    const approvalStatusBadge = document.getElementById('approvalStatusBadge');
                    approvalStatusBadge.className = 'info-badge badge-approved';
                    approvalStatusBadge.textContent = '已通过';
                    
                    // 更新项目状态
                    const statusBadge = document.getElementById('statusBadge');
                    statusBadge.className = 'info-badge badge-completed';
                    statusBadge.textContent = '已完成';
                    
                    // 更新审批流程UI
                    const approvalSteps = document.querySelectorAll('.approval-step');
                    approvalSteps[1].classList.remove('current');
                    approvalSteps[1].classList.add('completed');
                    approvalSteps[2].classList.add('current');
                    
                    // 隐藏审批操作区
                    document.getElementById('approvalActions').style.display = 'none';
                    
                    // 添加到历史记录
                    addHistoryItem('审批通过', 'fa-check-circle');
                    
                    alert('项目已审批通过，可以进入发布阶段');
                }
            }
            
            // 驳回项目
            function rejectProject(projectData) {
                const reason = prompt('请输入驳回原因:');
                if (reason) {
                    // 更新审批状态
                    const approvalStatusBadge = document.getElementById('approvalStatusBadge');
                    approvalStatusBadge.className = 'info-badge badge-rejected';
                    approvalStatusBadge.textContent = '已驳回';
                    
                    // 更新项目状态
                    const statusBadge = document.getElementById('statusBadge');
                    statusBadge.className = 'info-badge badge-in-progress';
                    statusBadge.textContent = '进行中';
                    
                    // 隐藏审批操作区
                    document.getElementById('approvalActions').style.display = 'none';
                    
                    // 启用编辑按钮
                    document.getElementById('editProjectBtn').disabled = false;
                    document.getElementById('editProjectBtn').style.opacity = '1';
                    
                    // 显示提交审核按钮
                    document.getElementById('submitForReviewBtn').style.display = 'block';
                    
                    // 添加到历史记录
                    addHistoryItem(`审批驳回: ${reason}`, 'fa-times-circle');
                    
                    alert('项目已驳回，设计师可以继续编辑');
                }
            }
            
            // 添加历史记录
            function addHistoryItem(action, iconClass) {
                const historyContainer = document.querySelector('.info-card:last-child');
                const newHistoryItem = document.createElement('div');
                newHistoryItem.className = 'history-item';
                newHistoryItem.innerHTML = `
                    <div class="history-icon">
                        <i class="fas ${iconClass}"></i>
                    </div>
                    <div class="history-content">
                        <div class="history-action">${action}</div>
                        <div class="history-time">刚刚</div>
                    </div>
                `;
                
                // 插入到历史记录的顶部
                const firstHistoryItem = historyContainer.querySelector('.history-item');
                historyContainer.insertBefore(newHistoryItem, firstHistoryItem);
            }
        });
    </script>
</body>
</html> 