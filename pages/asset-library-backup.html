<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assets Library - CreativePro Studio</title>
    <link rel="stylesheet" href="../styles/kimtrue-brand.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #F5E1D9; /* 柔粉米色 (原为橙色 #F5E1D9) */
            --primary-rgb: 245, 225, 217; /* 柔粉米色RGB值，用于半透明效果 */
            --primary-light: rgba(245, 225, 217, 0.2);
            --primary-dark: #E8D5C8; /* 淡奶茶色，用于hover状态 */
            --secondary: #EADCD3; /* 果泥裸色 (原为粉色 #FFB5C5) */
            --text-primary: #4A4A4A;
            --text-secondary: #6E6E6E;
            --text-tertiary: #8E8E93;
            --gray-100: #F9F6F5;
            --gray-200: #F0EBE8;
            --gray-300: #E6DED9;
            --gray-400: #C7C7CC;
            --error: #D98E8E;
            --success: #A5C9BB;
            --warning: #E8D5A5;
            --white: #FFFFFF;
            --black: #000000;
            --border-radius-sm: 4px;
            --border-radius-md: 8px;
            --border-radius-lg: 12px;
            --border-radius-xl: 16px;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.03);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.03);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.02);
        }
        
        /* 全局样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        
        body {
            background-color: #F8F8F8;
            color: var(--text-primary);
            overflow-x: hidden;
        }
        
        /* 页面布局 */
        .page-container {
            display: flex;
            height: calc(100vh - 64px);
            overflow: hidden;
        }
        
        /* 平台布局容器 */
        .platform-container {
            display: flex;
            width: 100%;
            height: calc(100vh - 64px);
        }
        
        /* 侧边栏 */
        .sidebar {
            width: 240px;
            height: 100%;
            background-color: var(--white);
            border-right: 1px solid var(--gray-200);
            overflow-y: auto;
            padding: 20px 0;
            flex-shrink: 0;
        }
        
        .sidebar-item {
            padding: 0 20px;
            margin-bottom: 8px;
        }
        
        .sidebar-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-tertiary);
            margin: 24px 0 12px 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: var(--border-radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .sidebar-link i {
            margin-right: 8px;
            font-size: 16px;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-link:hover {
            background-color: var(--gray-100);
            color: var(--text-primary);
        }
        
        .sidebar-link.active {
            background-color: var(--primary-light);
            color: var(--primary);
            font-weight: 500;
        }
        
        /* 素材内容区域 */
        .materials-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .content-area {
            display: none;
        }
        
        .content-area.active {
            display: block;
        }
        
        .materials-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .materials-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .materials-subtitle {
            font-size: 14px;
            color: var(--text-tertiary);
        }
        
        .materials-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* 按钮样式 */
        .btn {
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 20px;
            padding: 0 16px;
            height: 36px;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .btn i {
            margin-right: 6px;
        }
        
        .btn:hover {
            background-color: var(--gray-100);
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: var(--text-secondary);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-outline {
            border: 1px solid var(--gray-300);
            background-color: white;
        }
        
        .btn-light {
            color: var(--text-secondary);
        }
        
        /* 搜索栏 */
        .search-bar {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .search-bar input {
            width: 240px;
            height: 36px;
            padding: 0 36px 0 12px;
            border-radius: 18px;
            border: 1px solid var(--gray-300);
            background-color: white;
            font-size: 14px;
        }
        
        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(var(--primary-rgb), 0.3);
        }
        
        .search-bar button {
            position: absolute;
            right: 8px;
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
        }
        
        /* 素材卡片样式 */
        .materials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            padding: 12px 0;
        }
        
        .material-card {
            border-radius: 12px;
            overflow: hidden;
            background-color: white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            position: relative;
        }
        
        .material-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .material-thumbnail {
            position: relative;
            height: 160px;
            overflow: hidden;
        }
        
        .material-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .material-card:hover .material-thumbnail img {
            transform: scale(1.05);
        }
        
        .material-tags {
            position: absolute;
            bottom: 8px;
            left: 8px;
            display: flex;
            gap: 4px;
        }
        
        .brand-tag,
        .material-type {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: white;
            backdrop-filter: blur(4px);
        }
        
        .brand-tag {
            background-color: rgba(var(--primary-rgb), 0.7);
        }
        
        .material-type {
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .material-info {
            padding: 12px;
        }
        
        .material-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .material-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-tertiary);
            font-size: 12px;
        }
        
        .material-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 6px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .material-card:hover .material-actions {
            opacity: 1;
        }
        
        .action-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            transform: scale(1.1);
            background-color: white;
        }
        
        /* 创建新素材卡片 */
        .create-new-material {
            border: 2px dashed var(--gray-300);
            background-color: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .create-new-material:hover {
            border-color: var(--primary);
            background-color: var(--primary-light);
        }
        
        .create-new-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 32px 16px;
        }
        
        .create-new-content i {
            font-size: 32px;
            color: var(--gray-400);
            margin-bottom: 12px;
        }
        
        .create-new-content p {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        /* 分类标签页 */
        .category-tabs {
            display: flex;
            gap: 24px;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--gray-200);
            padding-bottom: 8px;
        }
        
        .category-tab {
            background: none;
            border: none;
            padding: 8px 0;
            font-size: 14px;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
        }
        
        .category-tab.active {
            color: var(--primary);
            font-weight: 500;
        }
        
        .category-tab.active::after {
            content: '';
            position: absolute;
            bottom: -9px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--primary);
        }
        
        /* 标签筛选器 */
        .tag-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
        }
        
        .tag-filter {
            background-color: var(--gray-100);
            border: none;
            border-radius: 16px;
            padding: 6px 14px;
            font-size: 13px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tag-filter:hover {
            background-color: var(--gray-200);
        }
        
        .tag-filter.active {
            background-color: var(--primary);
            color: white;
        }
        
        /* 活跃的筛选条件 */
        .active-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 12px;
            background-color: var(--gray-100);
            border-radius: var(--border-radius-md);
        }
        
        .active-filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .filter-chip {
            background-color: white;
            border-radius: 16px;
            padding: 4px 10px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .filter-chip i {
            cursor: pointer;
            color: var(--text-tertiary);
        }
        
        .filter-chip i:hover {
            color: var(--error);
        }
        
        .clear-filters-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 13px;
        }
        
        /* 批量操作栏 */
        .bulk-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 12px;
            background-color: var(--gray-100);
            border-radius: var(--border-radius-md);
            font-size: 14px;
        }
        
        .bulk-action-buttons {
            display: flex;
            gap: 8px;
        }
        
        /* 分页 */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 32px;
        }
        
        .pagination-button {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: none;
            border: 1px solid var(--gray-300);
            cursor: pointer;
        }
        
        .pagination-button.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .pagination-button:disabled {
            color: var(--gray-300);
            cursor: not-allowed;
        }
        
        .pagination-ellipsis {
            width: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 模态窗口 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius-lg);
            width: 100%;
            max-width: 480px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .modal-close {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            color: var(--text-tertiary);
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .modal-footer {
            padding: 16px 24px;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            border-top: 1px solid var(--gray-200);
        }
        
        /* 筛选弹出菜单样式 */
        .filter-popover {
            position: absolute;
            top: 120px;
            right: 20px;
            width: 320px;
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease-out;
            overflow: hidden;
        }
        
        .filter-popover.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .filter-popover-header {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--gray-200);
            background-color: var(--gray-100);
        }
        
        .filter-popover-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin: 0;
            color: var(--text-primary);
        }
        
        .popover-close-btn {
            background: none;
            border: none;
            font-size: 16px;
            color: var(--text-tertiary);
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .popover-close-btn:hover {
            background-color: var(--gray-200);
            color: var(--text-primary);
        }
        
        .filter-popover-body {
            padding: 16px;
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--gray-300) transparent;
        }
        
        .filter-popover-body::-webkit-scrollbar {
            width: 6px;
        }
        
        .filter-popover-body::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .filter-popover-body::-webkit-scrollbar-thumb {
            background-color: var(--gray-300);
            border-radius: 3px;
        }
        
        .filter-popover-footer {
            padding: 12px 16px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            border-top: 1px solid var(--gray-200);
            background-color: var(--gray-100);
        }
        
        .filter-section {
            margin-bottom: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .filter-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
        }
        
        .filter-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background-color: var(--gray-200);
            margin-left: 8px;
        }
        
        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .filter-tag {
            background-color: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: 16px;
            padding: 6px 12px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);
            display: flex;
            align-items: center;
            gap: 4px;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .filter-tag:hover {
            background-color: var(--gray-200);
        }
        
        .filter-tag.active {
            background-color: var(--primary);
            color: var(--text-primary);
            border-color: var(--primary);
            box-shadow: 0 1px 2px rgba(var(--primary-rgb), 0.2);
        }
        
        .filter-tag.active:hover {
            background-color: var(--primary-dark);
        }
        
        .filter-checkboxes {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 6px 10px;
            border-radius: var(--border-radius-md);
            transition: background-color 0.15s;
            user-select: none;
        }
        
        .filter-checkbox:hover {
            background-color: var(--gray-100);
        }
        
        .filter-checkbox input {
            accent-color: var(--primary);
            width: 16px;
            height: 16px;
            cursor: pointer;
        }
        
        .checkbox-label {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* 上传素材弹窗样式 */
        .upload-popover {
            width: 380px;
        }
        
        .upload-methods {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: 16px;
        }
        
        .upload-method {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            background: none;
            border: none;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            gap: 6px;
        }
        
        .upload-method i {
            font-size: 18px;
        }
        
        .upload-method.active {
            color: var(--primary);
            font-weight: 500;
        }
        
        .upload-method.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 20%;
            right: 20%;
            height: 2px;
            background-color: var(--primary);
        }
        
        .upload-content {
            display: none;
            margin-bottom: 20px;
        }
        
        .upload-content.active {
            display: block;
        }
        
        .upload-dropzone {
            border: 2px dashed var(--gray-300);
            border-radius: var(--border-radius-md);
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .upload-dropzone:hover {
            border-color: var(--primary);
            background-color: var(--primary-light);
        }
        
        .upload-dropzone i {
            font-size: 32px;
            color: var(--gray-400);
            margin-bottom: 12px;
        }
        
        .upload-dropzone p {
            margin: 4px 0;
            color: var(--text-secondary);
        }
        
        .upload-hint,
        .input-hint,
        .create-hint {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-top: 8px;
        }
        
        .selected-files {
            margin-top: 16px;
        }
        
        .file-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .text-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 13px;
            cursor: pointer;
        }
        
        .file-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px;
            background-color: var(--gray-100);
            border-radius: var(--border-radius-md);
            margin-bottom: 8px;
        }
        
        .file-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--gray-200);
            border-radius: var(--border-radius-sm);
            margin-right: 10px;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-size: 13px;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .file-size {
            font-size: 12px;
            color: var(--text-tertiary);
        }
        
        .file-remove {
            color: var(--text-tertiary);
            border: none;
            background: none;
            cursor: pointer;
        }
        
        .file-remove:hover {
            color: var(--error);
        }
        
        .url-preview {
            height: 140px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .preview-placeholder {
            text-align: center;
            color: var(--text-tertiary);
        }
        
        .preview-placeholder i {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        .preview-placeholder p {
            font-size: 13px;
        }
        
        .create-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .create-option {
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .create-option:hover {
            border-color: var(--primary);
            background-color: var(--primary-light);
        }
        
        .create-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }
        
        .create-icon i {
            font-size: 24px;
            color: var(--primary);
        }
        
        .material-form {
            margin-top: 24px;
            border-top: 1px solid var(--gray-200);
            padding-top: 20px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            font-size: 14px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(var(--primary-rgb), 0.3);
        }
        
        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            padding: 6px;
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius-md);
            min-height: 38px;
        }
        
        .tag-input-container:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(var(--primary-rgb), 0.3);
        }
        
        .tag-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .tag-chip {
            background-color: var(--primary-light);
            color: var(--text-secondary);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
        }
        
        .tag-chip i {
            margin-left: 6px;
            cursor: pointer;
        }
        
        .tag-input {
            border: none;
            flex: 1;
            min-width: 80px;
            font-size: 14px;
            padding: 4px;
        }
        
        .tag-input:focus {
            outline: none;
        }
        
        .brand-options {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        .brand-option {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }
        
        .brand-option input {
            accent-color: var(--primary);
        }
        
        /* 当筛选激活时的样式 */
        #advanced-filter-btn.active {
            background-color: var(--primary-light);
            color: var(--primary);
        }
        
        /* 素材选择状态 */
        .material-card.selected {
            border: 2px solid var(--primary);
            box-shadow: 0 0 0 2px rgba(var(--primary-rgb), 0.3);
        }
        
        .material-card.selected::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: var(--primary);
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }
        
        .material-card.selected::after {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: 10px;
            left: 10px;
            width: 20px;
            height: 20px;
            z-index: 3;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
        }
        
        /* 列表视图样式 */
        .materials-grid.list-view {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .materials-grid.list-view .material-card {
            display: flex;
            height: 80px;
            padding-right: 12px;
        }
        
        .materials-grid.list-view .material-thumbnail {
            width: 80px;
            min-width: 80px;
            height: 80px;
        }
        
        .materials-grid.list-view .material-info {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .materials-grid.list-view .material-title {
            flex: 1;
            font-size: 14px;
            margin-bottom: 0;
        }
        
        .materials-grid.list-view .material-meta {
            display: flex;
            gap: 16px;
            width: auto;
        }
        
        .materials-grid.list-view .material-actions {
            position: static;
            opacity: 1;
            display: flex;
            align-items: center;
            margin-left: 12px;
        }
        
        .materials-grid.list-view .material-tags {
            top: 8px;
            bottom: auto;
        }
        
        .materials-grid.list-view .create-new-material {
            height: 80px;
        }
        
        .materials-grid.list-view .create-new-content {
            flex-direction: row;
            padding: 0 16px;
        }
        
        .materials-grid.list-view .create-new-content i {
            margin-right: 12px;
            margin-bottom: 0;
        }
        
        /* 触控反馈和可选择指示 */
        .material-card {
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .material-card:active {
            transform: scale(0.98);
        }
        
        /* 长按选择样式 */
        .material-card.long-press {
            animation: pulse 0.3s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(0.97); }
            100% { transform: scale(1); }
        }
        
        /* 触控友好的间距 */
        .action-btn {
            margin: 0 2px;
            width: 32px;
            height: 32px;
        }
        
        /* 筛选器和标签更清晰的交互状态 */
        .tag-filter:active, 
        .filter-tag:active,
        .category-tab:active {
            transform: scale(0.95);
        }
        
        /* 拖放上传区域更明显的状态 */
        .upload-dropzone.dragover {
            border-color: var(--primary);
            background-color: var(--primary-light);
            transform: scale(1.02);
        }
        
        /* 响应式优化 */
        @media (max-width: 768px) {
            .materials-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 16px;
            }
            
            .filter-popover {
                width: 280px;
            }
            
            .upload-popover {
                width: 320px;
            }
            
            .action-btn {
                width: 36px;
                height: 36px;
            }
        }
        
        /* 触控设备优化 */
        @media (pointer: coarse) {
            .sidebar-link,
            .btn,
            .tag-filter,
            .filter-tag,
            .pagination-button,
            .action-btn {
                min-height: 44px;
            }
            
            .sidebar-link {
                padding: 12px;
            }
            
            .tag-filter, 
            .filter-tag {
                padding: 8px 16px;
            }
        }
    </style>
    <style id="folder-interaction-styles">
    /* 文件夹和素材交互样式 */
    .empty-folder-message {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        grid-column: 1 / -1;
        padding: 40px;
        background-color: var(--gray-100);
        border-radius: var(--border-radius-lg);
        text-align: center;
    }

    .empty-folder-message i {
        font-size: 48px;
        color: var(--gray-300);
        margin-bottom: 16px;
    }

    .empty-folder-message p {
        color: var(--text-secondary);
        margin-bottom: 16px;
        font-size: 16px;
    }

    /* 素材选择和拖放样式 */
    .material-card.selectable {
        cursor: pointer;
        position: relative;
    }

    .material-card.selectable::before {
        content: '';
        position: absolute;
        top: 10px;
        left: 10px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 2px solid var(--gray-300);
        background-color: white;
        z-index: 5;
        box-sizing: border-box;
    }

    .material-card.selectable.selected::before {
        border-color: var(--primary);
        background-color: var(--primary);
    }

    .material-card.selectable.selected::after {
        content: '\f00c';
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
        position: absolute;
        top: 10px;
        left: 10px;
        width: 20px;
        height: 20px;
        z-index: 6;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 10px;
    }

    /* 通知提示样式 */
    .notification {
        position: fixed;
        bottom: -60px;
        left: 50%;
        transform: translateX(-50%);
        background-color: var(--primary);
        color: var(--text-primary);
        padding: 12px 24px;
        border-radius: 24px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        z-index: 9999;
        transition: bottom 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
        font-size: 14px;
        text-align: center;
    }

    .notification.active {
        bottom: 30px;
    }

    /* 素材选择网格 */
    .material-selection-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 16px;
        max-height: 360px;
        overflow-y: auto;
        padding: 8px 0;
    }

    .material-selection-item {
        cursor: pointer;
        border-radius: var(--border-radius-md);
        overflow: hidden;
        transition: all 0.2s;
        position: relative;
    }

    .material-selection-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
    }

    .selection-thumbnail {
        height: 100px;
        position: relative;
    }

    .selection-thumbnail img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .selection-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.2s;
    }

    .selection-overlay i {
        color: white;
        font-size: 24px;
    }

    .material-selection-item.selected .selection-overlay {
        opacity: 1;
        background-color: rgba(var(--primary-rgb), 0.6);
    }

    .selection-title {
        padding: 8px;
        font-size: 12px;
        color: var(--text-secondary);
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .no-materials-message {
        grid-column: 1 / -1;
        text-align: center;
        padding: 20px;
        color: var(--text-tertiary);
    }

    /* 文件夹选择列表 */
    .folder-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
        max-height: 300px;
        overflow-y: auto;
        padding: 8px 0;
    }

    .folder-option {
        display: flex;
        align-items: center;
        padding: 10px 12px;
        border-radius: var(--border-radius-md);
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .folder-option:hover {
        background-color: var(--gray-100);
    }

    .folder-option input[type="radio"] {
        margin-right: 12px;
        accent-color: var(--primary);
    }

    .folder-option label {
        display: flex;
        align-items: center;
        flex: 1;
        cursor: pointer;
    }

    .folder-option i {
        margin-right: 8px;
        color: var(--text-tertiary);
        font-size: 16px;
    }

    .folder-option:hover i {
        color: var(--primary);
    }

    /* 模态窗口指引文字 */
    .modal-instruction {
        margin-bottom: 16px;
        color: var(--text-secondary);
        font-size: 14px;
    }

    /* 文件夹高亮动画 */
    @keyframes folderPulse {
        0% { box-shadow: 0 0 0 0 rgba(var(--primary-rgb), 0.4); }
        70% { box-shadow: 0 0 0 10px rgba(var(--primary-rgb), 0); }
        100% { box-shadow: 0 0 0 0 rgba(var(--primary-rgb), 0); }
    }

    .folder-item .sidebar-link.active {
        animation: folderPulse 2s infinite;
    }

    /* 拖放区域样式 */
    .folder-dropzone {
        border: 2px dashed var(--gray-300);
        border-radius: var(--border-radius-md);
        background-color: var(--gray-100);
        padding: 20px;
        text-align: center;
        transition: all 0.2s;
    }

    .folder-dropzone.dragover {
        border-color: var(--primary);
        background-color: var(--primary-light);
    }

    .folder-dropzone-icon {
        font-size: 24px;
        color: var(--text-tertiary);
        margin-bottom: 10px;
    }

    .folder-dropzone-text {
        color: var(--text-secondary);
    }
    </style>
    <style>
    /* 素材类型选择 */
    .type-selection {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 10px;
        margin-top: 8px;
    }

    .type-option {
        position: relative;
    }

    .type-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
    }

    .type-option label {
        display: flex;
        align-items: center;
        padding: 10px;
        border-radius: var(--border-radius-md);
        border: 1px solid var(--gray-300);
        cursor: pointer;
        transition: all 0.2s;
    }

    .type-option label:hover {
        background-color: var(--gray-100);
    }

    .type-option input[type="radio"]:checked + label {
        background-color: var(--primary-light);
        border-color: var(--primary);
    }

    .type-option i {
        font-size: 16px;
        margin-right: 8px;
        color: var(--text-secondary);
    }

    .type-option input[type="radio"]:checked + label i {
        color: var(--primary);
    }

    /* 品牌选择 */
    .brand-selection {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 12px;
        margin-top: 8px;
    }

    .brand-option {
        position: relative;
    }

    .brand-option input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
    }

    .brand-option label {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 12px 8px;
        border-radius: var(--border-radius-md);
        border: 1px solid var(--gray-300);
        cursor: pointer;
        transition: all 0.2s;
    }

    .brand-option label:hover {
        background-color: var(--gray-100);
    }

    .brand-option input[type="radio"]:checked + label {
        background-color: var(--primary-light);
        border-color: var(--primary);
    }

    .brand-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 8px;
        font-weight: bold;
        color: white;
        font-size: 18px;
    }

    .generic-brand {
        background-color: var(--gray-300);
    }

    .anxiuze-brand {
        background-color: #A5C9BB;
    }

    .qichu-brand {
        background-color: #E8D5A5;
    }

    .ddg-brand {
        background-color: #D98E8E;
    }

    .optional-tag {
        font-size: 12px;
        color: var(--text-tertiary);
        font-weight: normal;
    }

    /* 增强上传表单UI */
    .material-form {
        margin-top: 24px;
        padding-top: 20px;
        border-top: 1px solid var(--gray-200);
    }

    .form-group label {
        display: block;
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 8px;
        color: var(--text-primary);
    }

    .upload-popover {
        width: 480px;
        max-width: 90vw;
    }

    /* 上传交互增强 */
    .upload-method {
        position: relative;
        overflow: hidden;
    }

    .upload-method::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 50%;
        right: 50%;
        height: 2px;
        background-color: var(--primary);
        transition: all 0.3s;
    }

    .upload-method.active::after {
        left: 20%;
        right: 20%;
    }

    .upload-dropzone {
        position: relative;
        overflow: hidden;
    }

    .upload-dropzone::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            linear-gradient(45deg, var(--primary-light) 25%, transparent 25%),
            linear-gradient(-45deg, var(--primary-light) 25%, transparent 25%),
            linear-gradient(45deg, transparent 75%, var(--primary-light) 75%),
            linear-gradient(-45deg, transparent 75%, var(--primary-light) 75%);
        background-size: 20px 20px;
        background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        opacity: 0;
        z-index: -1;
        transition: opacity 0.3s;
    }

    .upload-dropzone.dragover::after {
        opacity: 0.1;
    }
    </style>
    <style>
    /* 上传进度条样式 */
    .upload-progress-container {
        padding: 16px;
        margin-top: 16px;
        border-top: 1px solid var(--gray-200);
    }

    .upload-progress-text {
        font-size: 14px;
        color: var(--text-secondary);
        margin-bottom: 8px;
    }

    .upload-progress-bar {
        height: 6px;
        background-color: var(--gray-200);
        border-radius: 3px;
        overflow: hidden;
        position: relative;
    }

    .upload-progress-fill {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 0%;
        background-color: var(--primary);
        border-radius: 3px;
        transition: width 0.2s linear;
    }
    </style>
                
                <!-- 素材网格 -->
                <div class="materials-grid">
                    <!-- 品牌素材 -->
                    <div class="material-card kimtrue-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/3373736/pexels-photo-3373736.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="安修泽产品图">
                            <div class="material-tags">
                                <span class="brand-tag">安修泽</span>
                                <span class="material-type">图片</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">安修泽产品展示图</div>
                            <div class="material-meta">
                                <span>1200 x 1000px</span>
                                <span>2023-06-15</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <!-- 品牌素材 -->
                    <div class="material-card kimtrue-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/3373723/pexels-photo-3373723.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="安修泽logo">
                            <div class="material-tags">
                                <span class="brand-tag">安修泽</span>
                                <span class="material-type">Logo</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">安修泽品牌Logo</div>
                            <div class="material-meta">
                                <span>500 x 500px</span>
                                <span>2023-05-10</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <!-- 更多素材卡片 -->
                    <div class="material-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/5632402/pexels-photo-5632402.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="产品图片">
                            <div class="material-tags">
                                <span class="material-type">图片</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">产品展示图</div>
                            <div class="material-meta">
                                <span>1200 x 800px</span>
                                <span>2023-06-10</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <div class="material-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/5632398/pexels-photo-5632398.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="背景图片">
                            <div class="material-tags">
                                <span class="material-type">背景</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">渐变背景</div>
                            <div class="material-meta">
                                <span>1920 x 1080px</span>
                                <span>2023-05-25</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <div class="material-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/5632387/pexels-photo-5632387.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="图标">
                            <div class="material-tags">
                                <span class="material-type">图标</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">社交媒体图标集</div>
                            <div class="material-meta">
                                <span>64 x 64px</span>
                                <span>2023-04-18</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <div class="material-card">
                        <div class="material-thumbnail">
                            <img src="https://images.pexels.com/photos/5632385/pexels-photo-5632385.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260" alt="图形元素">
                            <div class="material-tags">
                                <span class="material-type">图形</span>
                            </div>
                        </div>
                        <div class="material-info">
                            <div class="material-title">几何图形集</div>
                            <div class="material-meta">
                                <span>800 x 800px</span>
                                <span>2023-06-05</span>
                            </div>
                        </div>
                        <div class="material-actions">
                            <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                            <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                            <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                    </div>
                    
                    <!-- 添加新素材卡片 -->
                    <div class="material-card create-new-material">
                        <div class="create-new-content">
                            <i class="fas fa-plus"></i>
                            <p>添加新素材</p>
                        </div>
                    </div>
                </div>
                
                <!-- 分页 -->
                <div class="pagination">
                    <button class="pagination-button" disabled><i class="fas fa-chevron-left"></i></button>
                    <button class="pagination-button active">1</button>
                    <button class="pagination-button">2</button>
                    <button class="pagination-button">3</button>
                    <span class="pagination-ellipsis">...</span>
                    <button class="pagination-button">10</button>
                    <button class="pagination-button"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- 上传素材对话框 -->
    <div id="upload-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">添加素材</h3>
                <button class="modal-close" id="close-upload-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- 上传方式选择 -->
                <div class="upload-tabs">
                    <button class="upload-tab active" data-target="file-upload-panel">
                        <i class="fas fa-cloud-upload-alt"></i> 本地上传
                    </button>
                    <button class="upload-tab" data-target="url-upload-panel">
                        <i class="fas fa-link"></i> 链接导入
                    </button>
                    <button class="upload-tab" data-target="template-panel">
                        <i class="fas fa-paint-brush"></i> 创建新素材
                    </button>
                </div>
                
                <!-- 上传面板 -->
                <div class="upload-panels">
                    <!-- 文件上传面板 -->
                    <div class="upload-panel active" id="file-upload-panel">
                        <div class="upload-dropzone" id="upload-dropzone">
                            <div class="upload-message">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>拖放文件到这里，或</p>
                                <button class="btn btn-primary select-file-btn" id="select-file-btn">选择文件</button>
                                <input type="file" id="file-input" multiple hidden>
                                <p class="upload-note">支持JPG、PNG、SVG、PDF格式，最大20MB</p>
                            </div>
                        </div>
                        
                        <!-- 已选文件列表 -->
                        <div class="selected-files" id="selected-files" style="display: none;">
                            <div class="file-list-header">
                                <h4>已选择的文件</h4>
                                <button class="clear-btn" id="clear-files">清除全部</button>
                            </div>
                            <ul class="file-list" id="file-list"></ul>
                        </div>
                    </div>
                    
                    <!-- URL导入面板 -->
                    <div class="upload-panel" id="url-upload-panel">
                        <div class="form-group">
                            <label for="url-input">输入素材链接</label>
                            <input type="url" id="url-input" class="form-control" placeholder="https://example.com/image.jpg">
                            <p class="form-help">支持直接图片链接或设计平台分享链接</p>
                        </div>
                        
                        <div class="url-preview">
                            <div class="preview-placeholder">
                                <i class="fas fa-image"></i>
                                <p>预览将显示在这里</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 模板创建面板 -->
                    <div class="upload-panel" id="template-panel">
                        <div class="template-grid">
                            <div class="template-item">
                                <div class="template-preview">
                                    <i class="fas fa-palette"></i>
                                </div>
                                <span>颜色板</span>
                            </div>
                            <div class="template-item">
                                <div class="template-preview">
                                    <i class="fas fa-font"></i>
                                </div>
                                <span>文字</span>
                            </div>
                            <div class="template-item">
                                <div class="template-preview">
                                    <i class="fas fa-shapes"></i>
                                </div>
                                <span>图形</span>
                            </div>
                            <div class="template-item">
                                <div class="template-preview">
                                    <i class="fas fa-border-all"></i>
                                </div>
                                <span>网格</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 共用表单区域 -->
                <div class="upload-form">
                    <div class="form-group">
                        <label for="material-name">素材名称</label>
                        <input type="text" id="material-name" class="form-control" placeholder="输入素材名称">
                    </div>
                    
                    <div class="form-group">
                        <label for="material-tags">标签</label>
                        <div class="tag-input-container">
                            <div class="tags-list" id="tags-list"></div>
                            <input type="text" id="material-tags" class="tag-input" placeholder="添加标签，按Enter确认">
                        </div>
                        <p class="form-help">添加标签以便更好地组织和查找素材</p>
                    </div>
                    
                    <div class="form-group">
                        <label>所属品牌</label>
                        <div class="brand-select">
                            <div class="brand-option">
                                <input type="radio" name="brand" id="brand-none" value="none" checked>
                                <label for="brand-none">无</label>
                            </div>
                            <div class="brand-option">
                                <input type="radio" name="brand" id="brand-anxiuze" value="anxiuze">
                                <label for="brand-anxiuze">安修泽</label>
                            </div>
                            <div class="brand-option">
                                <input type="radio" name="brand" id="brand-ddg" value="ddg">
                                <label for="brand-ddg">ddg</label>
                            </div>
                            <div class="brand-option">
                                <input type="radio" name="brand" id="brand-qichu" value="qichu">
                                <label for="brand-qichu">且初</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="material-folder">添加到文件夹</label>
                        <select id="material-folder" class="form-control">
                            <option value="">选择文件夹（可选）</option>
                            <option value="folder1">活动素材</option>
                            <option value="folder2">新品发布</option>
                            <option value="folder3">海报素材</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-upload">取消</button>
                <button class="btn btn-primary" id="confirm-upload">上传素材</button>
            </div>
        </div>
    </div>

    <!-- 添加素材弹窗 -->
    <div id="upload-popover" class="filter-popover upload-popover">
        <div class="filter-popover-header">
            <h3>添加素材</h3>
            <button class="popover-close-btn" id="close-upload-popover">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="filter-popover-body">
            <!-- 上传方式切换 -->
            <div class="upload-methods">
                <button class="upload-method active" data-method="local">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>本地上传</span>
                </button>
                <button class="upload-method" data-method="url">
                    <i class="fas fa-link"></i>
                    <span>URL导入</span>
                </button>
                <button class="upload-method" data-method="create">
                    <i class="fas fa-paint-brush"></i>
                    <span>创建素材</span>
                </button>
            </div>
            
            <!-- 上传内容区域 -->
            <div class="upload-content-area">
                <!-- 本地上传 -->
                <div class="upload-content active" id="local-upload-content">
                    <div class="upload-dropzone" id="upload-dropzone">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>拖放文件到这里</p>
                        <p>或</p>
                        <button class="btn btn-outline" id="select-file-btn">选择文件</button>
                        <input type="file" id="file-input" multiple hidden>
                        <p class="upload-hint">支持 JPG、PNG、SVG 等格式，单文件最大10MB</p>
                    </div>
                    
                    <!-- 已选文件列表 -->
                    <div class="selected-files" id="selected-files" style="display: none;">
                        <div class="file-list-header">
                            <span>已选择的文件</span>
                            <button class="text-btn" id="clear-files">清除全部</button>
                        </div>
                        <ul class="file-list" id="file-list"></ul>
                    </div>
                </div>
                
                <!-- URL导入 -->
                <div class="upload-content" id="url-upload-content">
                    <div class="form-group">
                        <label>输入图片URL</label>
                        <input type="url" class="form-input" placeholder="https://example.com/image.jpg">
                        <p class="input-hint">支持直接图片URL或设计平台分享链接</p>
                    </div>
                    
                    <div class="url-preview">
                        <div class="preview-placeholder">
                            <i class="fas fa-image"></i>
                            <p>输入URL后预览将显示在这里</p>
                        </div>
                    </div>
                </div>
                
                <!-- 创建素材 -->
                <div class="upload-content" id="create-upload-content">
                    <div class="create-options">
                        <div class="create-option">
                            <div class="create-icon">
                                <i class="fas fa-palette"></i>
                            </div>
                            <span>颜色板</span>
                        </div>
                        <div class="create-option">
                            <div class="create-icon">
                                <i class="fas fa-font"></i>
                            </div>
                            <span>文字</span>
                        </div>
                        <div class="create-option">
                            <div class="create-icon">
                                <i class="fas fa-shapes"></i>
                            </div>
                            <span>图形</span>
                        </div>
                        <div class="create-option">
                            <div class="create-icon">
                                <i class="fas fa-table"></i>
                            </div>
                            <span>网格</span>
                        </div>
                    </div>
                    <p class="create-hint">选择一种素材类型开始创建</p>
                </div>
            </div>
            
            <!-- 素材信息表单 -->
            <div class="material-form">
                <div class="form-group">
                    <label>素材名称</label>
                    <input type="text" class="form-input" placeholder="输入素材名称（选填）">
                </div>
                
                <div class="form-group">
                    <label>添加标签</label>
                    <div class="tag-input-container">
                        <div class="tag-chips" id="tag-chips"></div>
                        <input type="text" class="tag-input" id="tag-input" placeholder="输入标签，按Enter确认">
                    </div>
                    <p class="input-hint">标签可以帮助您更好地整理和查找素材</p>
                </div>
                
                <div class="form-group">
                    <label>品牌</label>
                    <div class="brand-options">
                        <label class="brand-option">
                            <input type="radio" name="brand" value="none" checked>
                            <span>无</span>
                        </label>
                        <label class="brand-option">
                            <input type="radio" name="brand" value="anxiuze">
                            <span>安修泽</span>
                        </label>
                        <label class="brand-option">
                            <input type="radio" name="brand" value="qichu">
                            <span>且初</span>
                        </label>
                        <label class="brand-option">
                            <input type="radio" name="brand" value="ddg">
                            <span>ddg</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>添加到文件夹 <span class="optional-tag">选填</span></label>
                    <select class="form-input" id="folder-select">
                        <option value="">选择文件夹</option>
                        <option value="folder1">活动素材</option>
                        <option value="folder2">新品发布</option>
                        <option value="folder3">海报素材</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="filter-popover-footer">
            <button class="btn btn-outline" id="cancel-upload">取消</button>
            <button class="btn btn-primary" id="confirm-upload">上传素材</button>
        </div>
    </div>

    <!-- 筛选弹出菜单 -->
    <div id="filter-popover" class="filter-popover">
        <div class="filter-popover-header">
            <h3>筛选素材</h3>
            <button class="popover-close-btn" id="close-filter-popover">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="filter-popover-body">
            <div class="filter-section">
                <h4 class="filter-title">素材类型</h4>
                <div class="filter-tags">
                    <button class="filter-tag">图片</button>
                    <button class="filter-tag">视频</button>
                    <button class="filter-tag">图形</button>
                    <button class="filter-tag">图标</button>
                    <button class="filter-tag">背景</button>
                    <button class="filter-tag">Logo</button>
                </div>
            </div>
            
            <div class="filter-section">
                <h4 class="filter-title">标签</h4>
                <div class="filter-tags">
                    <button class="filter-tag">产品</button>
                    <button class="filter-tag">设计元素</button>
                    <button class="filter-tag">品牌标识</button>
                    <button class="filter-tag">促销</button>
                    <button class="filter-tag">配色</button>
                    <button class="filter-tag">模板</button>
                </div>
            </div>
            
            <div class="filter-section">
                <h4 class="filter-title">品牌</h4>
                <div class="filter-checkboxes">
                    <label class="filter-checkbox">
                        <input type="checkbox" name="brand" value="anxiuze">
                        <span class="checkbox-label">安修泽</span>
                    </label>
                    <label class="filter-checkbox">
                        <input type="checkbox" name="brand" value="qichu">
                        <span class="checkbox-label">且初</span>
                    </label>
                    <label class="filter-checkbox">
                        <input type="checkbox" name="brand" value="ddg">
                        <span class="checkbox-label">ddg</span>
                    </label>
                    <label class="filter-checkbox">
                        <input type="checkbox" name="brand" value="other">
                        <span class="checkbox-label">其他</span>
                    </label>
                </div>
            </div>
            
            <div class="filter-section">
                <h4 class="filter-title">时间范围</h4>
                <div class="filter-tags">
                    <button class="filter-tag">今天</button>
                    <button class="filter-tag">本周</button>
                    <button class="filter-tag">本月</button>
                    <button class="filter-tag">今年</button>
                    <button class="filter-tag">全部</button>
                </div>
            </div>
            
            <div class="filter-section">
                <h4 class="filter-title">存储位置</h4>
                <div class="filter-checkboxes">
                    <label class="filter-checkbox">
                        <input type="checkbox" name="location" value="local">
                        <span class="checkbox-label">本地</span>
                    </label>
                    <label class="filter-checkbox">
                        <input type="checkbox" name="location" value="cloud">
                        <span class="checkbox-label">云端</span>
                    </label>
                    <label class="filter-checkbox">
                        <input type="checkbox" name="location" value="shared">
                        <span class="checkbox-label">共享</span>
                    </label>
                </div>
            </div>
        </div>
        <div class="filter-popover-footer">
            <button class="btn btn-outline" id="reset-filter">重置</button>
            <button class="btn btn-primary" id="apply-filter">应用筛选</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 侧边栏导航切换
            const sidebarLinks = document.querySelectorAll('.sidebar-link');
            
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    // 移除所有链接的激活状态
                    sidebarLinks.forEach(l => l.classList.remove('active'));
                    // 激活当前链接
                    this.classList.add('active');
                    
                    // 显示对应的内容区域（在实际应用中还需处理内容切换）
                    const type = this.getAttribute('data-type');
                    console.log(`切换到: ${type}`);
                });
            });
            
            // 分类标签切换
            const categoryTabs = document.querySelectorAll('.category-tab');
            
            categoryTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // 移除所有标签的激活状态
                    categoryTabs.forEach(t => t.classList.remove('active'));
                    // 激活当前标签
                    this.classList.add('active');
                });
            });
            
            // 标签筛选器切换
            const tagFilters = document.querySelectorAll('.tag-filter');
            
            tagFilters.forEach(filter => {
                filter.addEventListener('click', function() {
                    // 移除所有的激活状态（除了"全部标签"）
                    if (this.textContent.includes('全部标签')) {
                        tagFilters.forEach(f => {
                            if (!f.textContent.includes('全部标签')) {
                                f.classList.remove('active');
                            }
                        });
                        this.classList.add('active');
                    } else {
                        // 取消"全部标签"的激活状态
                        tagFilters.forEach(f => {
                            if (f.textContent.includes('全部标签')) {
                                f.classList.remove('active');
                            }
                        });
                        
                        // 切换当前标签的激活状态
                        this.classList.toggle('active');
                        
                        // 如果没有激活的标签，则激活"全部标签"
                        const activeFilters = document.querySelectorAll('.tag-filter.active');
                        if (activeFilters.length === 0) {
                            tagFilters.forEach(f => {
                                if (f.textContent.includes('全部标签')) {
                                    f.classList.add('active');
                                }
                            });
                        }
                    }
                });
            });
            
            // 视图切换
            const viewToggleBtn = document.getElementById('view-toggle-btn');
            
            if (viewToggleBtn) {
                viewToggleBtn.addEventListener('click', function() {
                    // 切换视图图标
                    const icon = this.querySelector('i');
                    if (icon.classList.contains('fa-th-large')) {
                        icon.classList.remove('fa-th-large');
                        icon.classList.add('fa-list');
                    } else {
                        icon.classList.remove('fa-list');
                        icon.classList.add('fa-th-large');
                    }
                    
                    // 处理视图样式切换
                    const materialsGrid = document.querySelector('.materials-grid');
                    if (materialsGrid) {
                        materialsGrid.classList.toggle('list-view');
                    }
                });
            }
            
            // 筛选弹出菜单
            const filterBtn = document.getElementById('advanced-filter-btn');
            const filterPopover = document.getElementById('filter-popover');
            const closeFilterBtn = document.getElementById('close-filter-popover');
            const resetFilterBtn = document.getElementById('reset-filter');
            const applyFilterBtn = document.getElementById('apply-filter');
            const filterTags = document.querySelectorAll('.filter-tag');
            const activeFilters = document.getElementById('active-filters');
            const clearFiltersBtn = document.querySelector('.clear-filters-btn');
            
            // 打开筛选菜单
            if (filterBtn && filterPopover) {
                filterBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    filterPopover.classList.toggle('active');
                    filterBtn.classList.toggle('active');
                    
                    // 关闭上传弹窗
                    const uploadPopover = document.getElementById('upload-popover');
                    if (uploadPopover) {
                        uploadPopover.classList.remove('active');
                    }
                    
                    // 调整筛选菜单位置，确保在视口内
                    adjustPopoverPosition(filterPopover);
                });
            }
            
            // 关闭筛选菜单
            if (closeFilterBtn && filterPopover && filterBtn) {
                closeFilterBtn.addEventListener('click', function() {
                    filterPopover.classList.remove('active');
                    filterBtn.classList.remove('active');
                });
            }
            
            // 点击外部关闭筛选菜单
            document.addEventListener('click', function(e) {
                if (filterPopover && filterBtn) {
                    if (!filterPopover.contains(e.target) && e.target !== filterBtn && !filterBtn.contains(e.target)) {
                        filterPopover.classList.remove('active');
                        filterBtn.classList.remove('active');
                    }
                }
                
                if (uploadPopover && uploadBtn) {
                    if (!uploadPopover.contains(e.target) && e.target !== uploadBtn && !uploadBtn.contains(e.target)) {
                        uploadPopover.classList.remove('active');
                    }
                }
            });
            
            // 筛选标签点击切换
            if (filterTags.length > 0) {
                filterTags.forEach(tag => {
                    tag.addEventListener('click', function() {
                        this.classList.toggle('active');
                        
                        // 添加点击波纹效果
                        addRippleEffect(this, event);
                    });
                });
            }
            
            // 应用筛选
            if (applyFilterBtn && filterPopover && filterBtn && activeFilters) {
                applyFilterBtn.addEventListener('click', function() {
                    // 获取所有激活的筛选条件
                    const activeFilterTags = document.querySelectorAll('.filter-tag.active');
                    const activeCheckboxes = document.querySelectorAll('.filter-checkbox input:checked');
                    
                    // 如果有激活的筛选条件，显示筛选条件栏
                    if (activeFilterTags.length > 0 || activeCheckboxes.length > 0) {
                        // 创建筛选条件芯片
                        const filterChips = document.querySelector('.active-filter-chips');
                        if (filterChips) {
                            // 清空现有筛选条件
                            filterChips.innerHTML = '';
                            
                            // 添加标签类型筛选条件
                            activeFilterTags.forEach(tag => {
                                const chip = document.createElement('span');
                                chip.className = 'filter-chip';
                                chip.innerHTML = `${tag.textContent} <i class="fas fa-times"></i>`;
                                filterChips.appendChild(chip);
                            });
                            
                            // 添加复选框类型筛选条件
                            activeCheckboxes.forEach(checkbox => {
                                if (checkbox.nextElementSibling) {
                                    const chip = document.createElement('span');
                                    chip.className = 'filter-chip';
                                    chip.innerHTML = `${checkbox.nextElementSibling.textContent} <i class="fas fa-times"></i>`;
                                    filterChips.appendChild(chip);
                                }
                            });
                            
                            // 显示筛选条件栏
                            activeFilters.style.display = 'flex';
                            
                            // 应用筛选效果到素材列表
                            applyFiltersToMaterials(activeFilterTags, activeCheckboxes);
                        }
                    } else {
                        // 没有筛选条件则隐藏筛选条件栏
                        activeFilters.style.display = 'none';
                        
                        // 显示所有素材
                        resetMaterialsDisplay();
                    }
                    
                    // 关闭筛选菜单并添加动画效果
                    filterPopover.style.transition = 'all 0.2s ease-out';
                    filterPopover.style.transform = 'translateY(-10px)';
                    filterPopover.style.opacity = '0';
                    
                    setTimeout(() => {
                        filterPopover.classList.remove('active');
                        filterBtn.classList.remove('active');
                        // 重置样式以便下次打开
                        setTimeout(() => {
                            filterPopover.style.transition = '';
                            filterPopover.style.transform = '';
                            filterPopover.style.opacity = '';
                        }, 200);
                    }, 150);
                });
            }
            
            // 重置筛选
            if (resetFilterBtn && filterTags.length > 0) {
                resetFilterBtn.addEventListener('click', function() {
                    // 添加动画效果
                    const filterSections = document.querySelectorAll('.filter-section');
                    filterSections.forEach((section, index) => {
                        section.style.animation = 'none';
                        void section.offsetWidth; // 触发重绘
                        section.style.animation = `fadeIn 0.3s ease-out ${index * 0.05}s`;
                    });
                    
                    // 重置所有标签
                    filterTags.forEach(tag => {
                        tag.classList.remove('active');
                    });
                    
                    // 重置所有复选框
                    document.querySelectorAll('.filter-checkbox input').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                });
            }
            
            // 清除全部筛选条件
            if (clearFiltersBtn && activeFilters && filterTags.length > 0) {
                clearFiltersBtn.addEventListener('click', function() {
                    // 隐藏筛选条件栏并添加动画
                    activeFilters.style.transition = 'all 0.2s ease-out';
                    activeFilters.style.opacity = '0';
                    activeFilters.style.transform = 'translateY(-10px)';
                    
                    setTimeout(() => {
                        activeFilters.style.display = 'none';
                        // 重置样式以便下次显示
                        activeFilters.style.transition = '';
                        activeFilters.style.opacity = '';
                        activeFilters.style.transform = '';
                    }, 200);
                    
                    // 同时重置筛选菜单中的选择
                    filterTags.forEach(tag => {
                        tag.classList.remove('active');
                    });
                    
                    document.querySelectorAll('.filter-checkbox input').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    
                    // 显示所有素材
                    resetMaterialsDisplay();
                });
            }
            
            // 删除单个筛选条件
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('fa-times') && e.target.parentElement && e.target.parentElement.classList.contains('filter-chip')) {
                    const chipText = e.target.parentElement.textContent.trim().slice(0, -1).trim();
                    
                    // 添加删除动画
                    const chip = e.target.parentElement;
                    chip.style.transition = 'all 0.15s ease-out';
                    chip.style.opacity = '0';
                    chip.style.transform = 'scale(0.8)';
                    
                    setTimeout(() => {
                        chip.remove();
                        
                        // 如果没有筛选条件了，隐藏筛选条件栏
                        if (document.querySelectorAll('.filter-chip').length === 0 && activeFilters) {
                            activeFilters.style.transition = 'all 0.2s ease-out';
                            activeFilters.style.opacity = '0';
                            activeFilters.style.transform = 'translateY(-10px)';
                            
                            setTimeout(() => {
                                activeFilters.style.display = 'none';
                                // 重置样式以便下次显示
                                activeFilters.style.transition = '';
                                activeFilters.style.opacity = '';
                                activeFilters.style.transform = '';
                            }, 200);
                        }
                    }, 150);
                    
                    // 同时取消筛选菜单中的对应选择
                    if (filterTags) {
                        filterTags.forEach(tag => {
                            if (tag.textContent.trim() === chipText) {
                                tag.classList.remove('active');
                            }
                        });
                    }
                    
                    document.querySelectorAll('.filter-checkbox input').forEach(checkbox => {
                        if (checkbox.nextElementSibling && checkbox.nextElementSibling.textContent.trim() === chipText) {
                            checkbox.checked = false;
                        }
                    });
                    
                    // 重新应用剩余的筛选条件
                    updateFiltersEffect();
                }
            });
            
            // 添加素材交互
            const uploadBtn = document.querySelector('.upload-btn');
            const uploadPopover = document.getElementById('upload-popover');
            const closeUploadBtn = document.getElementById('close-upload-popover');
            const cancelUploadBtn = document.getElementById('cancel-upload');
            const confirmUploadBtn = document.getElementById('confirm-upload');
            const createNewMaterial = document.getElementById('create-new-material');
            
            // 上传方法切换
            const uploadMethods = document.querySelectorAll('.upload-method');
            const uploadContents = document.querySelectorAll('.upload-content');
            
            // 文件上传相关元素
            const fileInput = document.getElementById('file-input');
            const selectFileBtn = document.getElementById('select-file-btn');
            const uploadDropzone = document.getElementById('upload-dropzone');
            const selectedFiles = document.getElementById('selected-files');
            const fileList = document.getElementById('file-list');
            const clearFilesBtn = document.getElementById('clear-files');
            
            // 标签输入
            const tagInput = document.getElementById('tag-input');
            const tagChips = document.getElementById('tag-chips');
            
            // 打开上传菜单
            if (uploadBtn && uploadPopover) {
                uploadBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    uploadPopover.classList.toggle('active');
                    
                    // 关闭筛选弹窗
                    if (filterPopover && filterBtn) {
                        filterPopover.classList.remove('active');
                        filterBtn.classList.remove('active');
                    }
                    
                    // 调整上传菜单位置
                    adjustPopoverPosition(uploadPopover);
                });
            }
            
            if (createNewMaterial && uploadPopover) {
                createNewMaterial.addEventListener('click', function() {
                    uploadPopover.classList.add('active');
                    
                    // 调整上传菜单位置
                    adjustPopoverPosition(uploadPopover);
                });
            }
            
            // 关闭上传菜单
            if (closeUploadBtn && uploadPopover) {
                closeUploadBtn.addEventListener('click', function() {
                    uploadPopover.classList.remove('active');
                });
            }
            
            if (cancelUploadBtn && uploadPopover) {
                cancelUploadBtn.addEventListener('click', function() {
                    uploadPopover.classList.remove('active');
                });
            }
            
            // 切换上传方法
            if (uploadMethods.length > 0 && uploadContents.length > 0) {
                uploadMethods.forEach(method => {
                    method.addEventListener('click', function() {
                        // 移除所有方法的激活状态
                        uploadMethods.forEach(m => m.classList.remove('active'));
                        // 激活当前方法
                        this.classList.add('active');
                        
                        // 获取当前方法类型
                        const methodType = this.getAttribute('data-method');
                        const targetContent = document.getElementById(`${methodType}-upload-content`);
                        
                        // 隐藏所有内容区域
                        uploadContents.forEach(content => content.classList.remove('active'));
                        
                        // 显示当前方法对应的内容区域
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                    });
                });
            }
            
            // 选择文件按钮
            if (selectFileBtn && fileInput) {
                selectFileBtn.addEventListener('click', function() {
                    fileInput.click();
                });
            }
            
            // 文件拖放区域
            if (uploadDropzone) {
                uploadDropzone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--primary)';
                    this.style.backgroundColor = 'var(--primary-light)';
                    this.classList.add('dragover');
                });
                
                uploadDropzone.addEventListener('dragleave', function() {
                    this.style.borderColor = '';
                    this.style.backgroundColor = '';
                    this.classList.remove('dragover');
                });
                
                uploadDropzone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '';
                    this.style.backgroundColor = '';
                    this.classList.remove('dragover');
                    
                    if (e.dataTransfer.files.length > 0) {
                        handleFiles(e.dataTransfer.files);
                    }
                });
            }
            
            // 文件选择
            if (fileInput) {
                fileInput.addEventListener('change', function() {
                    if (this.files.length > 0) {
                        handleFiles(this.files);
                    }
                });
            }
            
            // 处理文件
            function handleFiles(files) {
                if (selectedFiles && fileList) {
                    selectedFiles.style.display = 'block';
                    
                    for (let i = 0; i < files.length; i++) {
                        addFileToList(files[i]);
                    }
                }
            }
            
            // 添加文件到列表
            function addFileToList(file) {
                if (!fileList) return;
                
                const fileItem = document.createElement('li');
                fileItem.className = 'file-item';
                
                // 获取文件类型图标
                let fileIconClass = 'fa-file';
                if (file.type.startsWith('image/')) {
                    fileIconClass = 'fa-file-image';
                } else if (file.type === 'application/pdf') {
                    fileIconClass = 'fa-file-pdf';
                } else if (file.type.includes('word')) {
                    fileIconClass = 'fa-file-word';
                }
                
                // 格式化文件大小
                const fileSize = formatFileSize(file.size);
                
                fileItem.innerHTML = `
                    <div class="file-icon">
                        <i class="fas ${fileIconClass}"></i>
                    </div>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${fileSize}</div>
                    </div>
                    <button class="file-remove">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                fileList.appendChild(fileItem);
                
                // 绑定移除按钮事件
                const removeBtn = fileItem.querySelector('.file-remove');
                if (removeBtn && selectedFiles) {
                    removeBtn.addEventListener('click', function() {
                        fileItem.remove();
                        
                        // 如果列表为空，隐藏文件列表区域
                        if (fileList.children.length === 0) {
                            selectedFiles.style.display = 'none';
                        }
                    });
                }
            }
            
            // 清除文件列表
            if (clearFilesBtn && fileList && selectedFiles && fileInput) {
                clearFilesBtn.addEventListener('click', function() {
                    fileList.innerHTML = '';
                    selectedFiles.style.display = 'none';
                    fileInput.value = '';
                });
            }
            
            // 标签输入
            if (tagInput && tagChips) {
                tagInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && this.value.trim()) {
                        e.preventDefault();
                        addTag(this.value.trim());
                        this.value = '';
                    }
                });
            }
            
            // 添加标签
            function addTag(tagText) {
                if (!tagChips) return;
                
                const tagChip = document.createElement('div');
                tagChip.className = 'tag-chip';
                tagChip.innerHTML = `${tagText} <i class="fas fa-times"></i>`;
                
                tagChips.appendChild(tagChip);
                
                // 绑定删除标签事件
                const removeIcon = tagChip.querySelector('i');
                if (removeIcon) {
                    removeIcon.addEventListener('click', function() {
                        tagChip.remove();
                    });
                }
            }
            
            // 确认上传
            if (confirmUploadBtn && uploadPopover && fileList && selectedFiles && fileInput && tagChips) {
                confirmUploadBtn.addEventListener('click', function() {
                    // 这里添加上传逻辑
                    alert('素材上传成功！');
                    
                    // 关闭弹窗
                    uploadPopover.classList.remove('active');
                    
                    // 重置表单
                    fileList.innerHTML = '';
                    selectedFiles.style.display = 'none';
                    fileInput.value = '';
                    tagChips.innerHTML = '';
                });
            }
            
            // 格式化文件大小
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            // 调整弹出框位置，确保在视口内
            function adjustPopoverPosition(popover) {
                if (!popover) return;
                
                // 重置位置
                popover.style.top = '120px';
                popover.style.right = '20px';
                
                // 获取元素位置
                const rect = popover.getBoundingClientRect();
                
                // 检查是否超出视口底部
                if (rect.bottom > window.innerHeight) {
                    popover.style.top = (window.innerHeight - rect.height - 20) + 'px';
                }
                
                // 检查是否超出视口右侧
                if (rect.right > window.innerWidth) {
                    popover.style.right = '10px';
                    popover.style.left = 'auto';
                }
                
                // 检查是否超出视口左侧
                if (rect.left < 0) {
                    popover.style.left = '10px';
                    popover.style.right = 'auto';
                }
            }
            
            // 应用筛选效果到素材卡片
            function applyFiltersToMaterials(activeTags, activeCheckboxes) {
                const materialCards = document.querySelectorAll('.material-card');
                
                // 收集筛选条件
                const tagFilters = Array.from(activeTags).map(tag => tag.textContent.trim().toLowerCase());
                const brandFilters = Array.from(activeCheckboxes)
                    .filter(cb => cb.name === 'brand' && cb.nextElementSibling)
                    .map(cb => cb.nextElementSibling.textContent.trim().toLowerCase());
                
                const typeFilters = tagFilters.filter(tag => 
                    ['图片', '视频', '图形', '图标', '背景', 'logo'].includes(tag));
                
                const otherTagFilters = tagFilters.filter(tag => 
                    !['图片', '视频', '图形', '图标', '背景', 'logo'].includes(tag));
                
                // 应用筛选
                materialCards.forEach(card => {
                    // 跳过"添加新素材"卡片
                    if (card.classList.contains('create-new-material')) {
                        return;
                    }
                    
                    let shouldShow = true;
                    
                    // 类型筛选
                    if (typeFilters.length > 0) {
                        const cardType = card.querySelector('.material-type');
                        if (!cardType || !typeFilters.includes(cardType.textContent.trim().toLowerCase())) {
                            shouldShow = false;
                        }
                    }
                    
                    // 品牌筛选
                    if (brandFilters.length > 0 && shouldShow) {
                        const cardBrand = card.querySelector('.brand-tag');
                        if (!cardBrand || !brandFilters.includes(cardBrand.textContent.trim().toLowerCase())) {
                            shouldShow = false;
                        }
                    }
                    
                    // 其他标签筛选 (简化实现，实际应用需要更复杂的标签匹配)
                    // 这里假设材料标题可以用于标签匹配
                    if (otherTagFilters.length > 0 && shouldShow) {
                        const cardTitle = card.querySelector('.material-title');
                        if (!cardTitle || !otherTagFilters.some(tag => 
                            cardTitle.textContent.toLowerCase().includes(tag))) {
                            shouldShow = false;
                        }
                    }
                    
                    // 设置显示/隐藏
                    if (shouldShow) {
                        card.style.display = '';
                        // 添加显示动画
                        card.style.animation = 'none';
                        void card.offsetWidth; // 触发重绘
                        card.style.animation = 'fadeIn 0.3s ease-out';
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
            
            // 重置所有素材卡片的显示状态
            function resetMaterialsDisplay() {
                const materialCards = document.querySelectorAll('.material-card');
                
                materialCards.forEach(card => {
                    card.style.display = '';
                    // 添加显示动画
                    card.style.animation = 'none';
                    void card.offsetWidth; // 触发重绘
                    card.style.animation = 'fadeIn 0.3s ease-out';
                });
            }
            
            // 更新筛选效果
            function updateFiltersEffect() {
                // 获取剩余的筛选条件
                const remainingFilterChips = document.querySelectorAll('.filter-chip');
                
                if (remainingFilterChips.length > 0) {
                    // 重新应用筛选
                    const activeFilterTags = document.querySelectorAll('.filter-tag.active');
                    const activeCheckboxes = document.querySelectorAll('.filter-checkbox input:checked');
                    applyFiltersToMaterials(activeFilterTags, activeCheckboxes);
                } else {
                    // 如果没有筛选条件，显示所有素材
                    resetMaterialsDisplay();
                }
            }
            
            // 添加点击波纹效果
            function addRippleEffect(element, event) {
                const ripple = document.createElement('span');
                const rect = element.getBoundingClientRect();
                
                const size = Math.max(rect.width, rect.height);
                const x = event.clientX - rect.left - size / 2;
                const y = event.clientY - rect.top - size / 2;
                
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                ripple.className = 'ripple-effect';
                
                // 添加样式到document
                if (!document.querySelector('#ripple-style')) {
                    const style = document.createElement('style');
                    style.id = 'ripple-style';
                    style.textContent = `
                        .ripple-effect {
                            position: absolute;
                            border-radius: 50%;
                            background-color: rgba(255, 255, 255, 0.5);
                            transform: scale(0);
                            animation: ripple 0.6s linear;
                            pointer-events: none;
                        }
                        
                        @keyframes ripple {
                            to {
                                transform: scale(2);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
                
                // 确保元素是相对定位的
                if (getComputedStyle(element).position === 'static') {
                    element.style.position = 'relative';
                }
                
                element.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            }

            // 文件夹和素材的交互
            const folderItems = document.querySelectorAll('.folder-item');
            const addToFolderBtn = document.querySelector('.btn-outline[title="加入文件夹"]');
            const materialCards = document.querySelectorAll('.material-card');
            let selectedMaterials = [];

            // 文件夹选择
            if (folderItems.length > 0) {
                folderItems.forEach(folder => {
                    folder.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // 移除所有链接的激活状态
                        document.querySelectorAll('.sidebar-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        
                        // 激活当前文件夹
                        this.querySelector('.sidebar-link').classList.add('active');
                        
                        // 显示对应文件夹的内容
                        const folderId = this.getAttribute('data-folder-id');
                        showFolderContents(folderId);
                        
                        // 更新页面标题
                        const folderName = this.querySelector('.sidebar-link').textContent.trim();
                        updateContentHeader(folderName);
                        
                        // 显示"从文件夹移除"按钮
                        toggleFolderSpecificActions(true);
                    });
                });
            }

            // 显示文件夹内容
            function showFolderContents(folderId) {
                // 模拟数据，实际应用中应该从API获取
                const folderContents = {
                    'folder1': ['card1', 'card2'], // 活动素材
                    'folder2': ['card3'],          // 新品发布
                    'folder3': ['card2', 'card3', 'card4'] // 海报素材
                };
                
                // 为演示添加ID到素材卡片
                if (!document.querySelector('.material-card[data-card-id]')) {
                    const cards = document.querySelectorAll('.material-card:not(.create-new-material)');
                    cards.forEach((card, index) => {
                        card.setAttribute('data-card-id', `card${index + 1}`);
                    });
                }
                
                // 显示所有素材
                document.querySelectorAll('.material-card').forEach(card => {
                    // 跳过添加新素材卡片
                    if (card.classList.contains('create-new-material')) return;
                    
                    // 初始隐藏所有素材
                    card.style.display = 'none';
                    card.classList.remove('folder-item');
                });
                
                // 显示该文件夹中的素材
                if (folderContents[folderId]) {
                    folderContents[folderId].forEach(cardId => {
                        const card = document.querySelector(`.material-card[data-card-id="${cardId}"]`);
                        if (card) {
                            card.style.display = '';
                            card.classList.add('folder-item');
                            
                            // 添加平滑出现动画
                            card.style.animation = 'none';
                            void card.offsetWidth; // 触发重绘
                            card.style.animation = 'fadeIn 0.3s ease-out';
                        }
                    });
                }
                
                // 显示文件夹为空的提示（如果没有内容）
                const materialsGrid = document.querySelector('.materials-grid');
                const emptyFolderMessage = document.getElementById('empty-folder-message');
                
                if (folderContents[folderId] && folderContents[folderId].length === 0) {
                    // 创建空文件夹提示（如果不存在）
                    if (!emptyFolderMessage) {
                        const message = document.createElement('div');
                        message.id = 'empty-folder-message';
                        message.className = 'empty-folder-message';
                        message.innerHTML = `
                            <i class="fas fa-folder-open"></i>
                            <p>此文件夹为空</p>
                            <button class="btn btn-outline">添加素材</button>
                        `;
                        materialsGrid.appendChild(message);
                        
                        // 为添加素材按钮添加点击事件
                        message.querySelector('button').addEventListener('click', () => {
                            showAddToFolderModal(folderId);
                        });
                    } else {
                        emptyFolderMessage.style.display = 'flex';
                    }
                } else if (emptyFolderMessage) {
                    emptyFolderMessage.style.display = 'none';
                }
            }

            // 更新内容区域标题
            function updateContentHeader(title) {
                const materialsTitle = document.querySelector('.materials-title');
                const materialsSubtitle = document.querySelector('.materials-subtitle');
                
                if (materialsTitle) {
                    materialsTitle.textContent = title;
                }
                
                if (materialsSubtitle) {
                    materialsSubtitle.textContent = '文件夹中的素材资源';
                }
            }

            // 切换文件夹特定的操作按钮
            function toggleFolderSpecificActions(show) {
                // 如果存在"从文件夹移除"按钮，则切换显示状态
                let removeFromFolderBtn = document.getElementById('remove-from-folder-btn');
                
                if (show) {
                    if (!removeFromFolderBtn) {
                        // 创建"从文件夹移除"按钮
                        const materialsActions = document.querySelector('.materials-actions');
                        if (materialsActions) {
                            removeFromFolderBtn = document.createElement('button');
                            removeFromFolderBtn.id = 'remove-from-folder-btn';
                            removeFromFolderBtn.className = 'btn btn-outline';
                            removeFromFolderBtn.innerHTML = '<i class="fas fa-folder-minus"></i> 从文件夹移除';
                            
                            // 查找插入位置（搜索栏之后）
                            const searchBar = materialsActions.querySelector('.search-bar');
                            if (searchBar) {
                                searchBar.insertAdjacentElement('afterend', removeFromFolderBtn);
                            } else {
                                materialsActions.appendChild(removeFromFolderBtn);
                            }
                            
                            // 添加点击事件
                            removeFromFolderBtn.addEventListener('click', () => {
                                toggleMaterialSelection(true);
                            });
                        }
                    } else {
                        removeFromFolderBtn.style.display = '';
                    }
                } else if (removeFromFolderBtn) {
                    removeFromFolderBtn.style.display = 'none';
                }
            }

            // 素材选择模式切换
            function toggleMaterialSelection(enable) {
                const bulkActions = document.querySelector('.bulk-actions');
                const materialCards = document.querySelectorAll('.material-card.folder-item');
                
                if (enable) {
                    // 启用选择模式
                    materialCards.forEach(card => {
                        card.classList.add('selectable');
                        
                        // 添加选择事件
                        card.addEventListener('click', selectMaterial);
                    });
                    
                    // 显示批量操作栏并更新文本
                    if (bulkActions) {
                        const actionText = bulkActions.querySelector('div:first-child');
                        if (actionText) {
                            actionText.innerHTML = '选择要从文件夹中移除的素材';
                        }
                        
                        // 更新按钮区域
                        const actionButtons = bulkActions.querySelector('.bulk-action-buttons');
                        if (actionButtons) {
                            actionButtons.innerHTML = `
                                <button class="btn btn-primary" id="confirm-remove-btn">确认移除</button>
                                <button class="btn btn-outline cancel-selection">取消</button>
                            `;
                            
                            // 添加确认移除事件
                            const confirmRemoveBtn = document.getElementById('confirm-remove-btn');
                            if (confirmRemoveBtn) {
                                confirmRemoveBtn.addEventListener('click', removeSelectedFromFolder);
                            }
                            
                            // 添加取消选择事件
                            const cancelBtn = bulkActions.querySelector('.cancel-selection');
                            if (cancelBtn) {
                                cancelBtn.addEventListener('click', () => {
                                    toggleMaterialSelection(false);
                                });
                            }
                        }
                        
                        bulkActions.style.display = 'flex';
                    }
                } else {
                    // 禁用选择模式
                    materialCards.forEach(card => {
                        card.classList.remove('selectable');
                        card.classList.remove('selected');
                        
                        // 移除选择事件
                        card.removeEventListener('click', selectMaterial);
                    });
                    
                    // 清空选择的素材
                    selectedMaterials = [];
                    
                    // 隐藏批量操作栏
                    if (bulkActions) {
                        bulkActions.style.display = 'none';
                    }
                }
            }

            // 素材选择事件处理
            function selectMaterial(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const card = this;
                const cardId = card.getAttribute('data-card-id');
                
                // 切换选择状态
                card.classList.toggle('selected');
                
                // 更新选择列表
                if (card.classList.contains('selected')) {
                    selectedMaterials.push(cardId);
                } else {
                    selectedMaterials = selectedMaterials.filter(id => id !== cardId);
                }
                
                // 更新选择计数
                updateSelectionCount();
            }

            // 更新选择计数
            function updateSelectionCount() {
                const countElement = document.getElementById('selected-count');
                if (countElement) {
                    countElement.textContent = selectedMaterials.length;
                }
            }

            // 从文件夹中移除选中的素材
            function removeSelectedFromFolder() {
                if (selectedMaterials.length === 0) return;
                
                // 获取当前活动的文件夹
                const activeFolder = document.querySelector('.folder-item .sidebar-link.active');
                if (!activeFolder) return;
                
                const folderId = activeFolder.parentElement.getAttribute('data-folder-id');
                
                // 模拟从文件夹中移除素材
                selectedMaterials.forEach(cardId => {
                    const card = document.querySelector(`.material-card[data-card-id="${cardId}"]`);
                    if (card) {
                        // 添加移除动画
                        card.style.transition = 'all 0.3s ease-out';
                        card.style.opacity = '0';
                        card.style.transform = 'scale(0.8)';
                        
                        setTimeout(() => {
                            card.style.display = 'none';
                            card.classList.remove('folder-item');
                            card.classList.remove('selected');
                            
                            // 重置样式
                            card.style.transition = '';
                            card.style.opacity = '';
                            card.style.transform = '';
                        }, 300);
                    }
                });
                
                // 显示操作成功提示
                showNotification('已从文件夹中移除选定的素材');
                
                // 检查文件夹是否为空
                setTimeout(() => {
                    const visibleCards = document.querySelectorAll('.material-card.folder-item[style*="display: none"]');
                    if (visibleCards.length === 0) {
                        // 显示空文件夹提示
                        const materialsGrid = document.querySelector('.materials-grid');
                        let emptyFolderMessage = document.getElementById('empty-folder-message');
                        
                        if (!emptyFolderMessage) {
                            emptyFolderMessage = document.createElement('div');
                            emptyFolderMessage.id = 'empty-folder-message';
                            emptyFolderMessage.className = 'empty-folder-message';
                            emptyFolderMessage.innerHTML = `
                                <i class="fas fa-folder-open"></i>
                                <p>此文件夹为空</p>
                                <button class="btn btn-outline">添加素材</button>
                            `;
                            materialsGrid.appendChild(emptyFolderMessage);
                            
                            // 为添加素材按钮添加点击事件
                            emptyFolderMessage.querySelector('button').addEventListener('click', () => {
                                showAddToFolderModal(folderId);
                            });
                        } else {
                            emptyFolderMessage.style.display = 'flex';
                        }
                    }
                }, 350);
                
                // 重置选择模式
                toggleMaterialSelection(false);
            }

            // 显示添加到文件夹的模态窗口
            function showAddToFolderModal(targetFolderId) {
                // 检查模态窗口是否已存在
                let addToFolderModal = document.getElementById('add-to-folder-modal');
                
                if (!addToFolderModal) {
                    // 创建模态窗口
                    addToFolderModal = document.createElement('div');
                    addToFolderModal.id = 'add-to-folder-modal';
                    addToFolderModal.className = 'modal-overlay';
                    
                    // 获取文件夹名称
                    const folderName = document.querySelector(`.folder-item[data-folder-id="${targetFolderId}"] .sidebar-link`).textContent.trim();
                    
                    addToFolderModal.innerHTML = `
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">添加素材到 "${folderName}"</h3>
                                <button class="modal-close" id="close-folder-modal">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p class="modal-instruction">选择要添加到此文件夹的素材：</p>
                                
                                <div class="material-selection-grid">
                                    <!-- 这里将动态填充素材选项 -->
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-outline" id="cancel-add-to-folder">取消</button>
                                <button class="btn btn-primary" id="confirm-add-to-folder">添加到文件夹</button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(addToFolderModal);
                    
                    // 填充素材选项
                    const selectionGrid = addToFolderModal.querySelector('.material-selection-grid');
                    const materialCards = document.querySelectorAll('.material-card:not(.create-new-material):not(.folder-item)');
                    
                    if (materialCards.length > 0) {
                        materialCards.forEach(card => {
                            const cardId = card.getAttribute('data-card-id');
                            const thumbnail = card.querySelector('.material-thumbnail img').src;
                            const title = card.querySelector('.material-title').textContent;
                            
                            const selectionItem = document.createElement('div');
                            selectionItem.className = 'material-selection-item';
                            selectionItem.setAttribute('data-card-id', cardId);
                            selectionItem.innerHTML = `
                                <div class="selection-thumbnail">
                                    <img src="${thumbnail}" alt="${title}">
                                    <div class="selection-overlay">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="selection-title">${title}</div>
                            `;
                            
                            selectionGrid.appendChild(selectionItem);
                            
                            // 添加选择事件
                            selectionItem.addEventListener('click', function() {
                                this.classList.toggle('selected');
                            });
                        });
                    } else {
                        selectionGrid.innerHTML = '<p class="no-materials-message">没有可添加的素材</p>';
                    }
                    
                    // 添加事件监听
                    const closeBtn = document.getElementById('close-folder-modal');
                    const cancelBtn = document.getElementById('cancel-add-to-folder');
                    const confirmBtn = document.getElementById('confirm-add-to-folder');
                    
                    closeBtn.addEventListener('click', () => {
                        addToFolderModal.classList.remove('active');
                    });
                    
                    cancelBtn.addEventListener('click', () => {
                        addToFolderModal.classList.remove('active');
                    });
                    
                    confirmBtn.addEventListener('click', () => {
                        // 获取选中的素材
                        const selectedItems = addToFolderModal.querySelectorAll('.material-selection-item.selected');
                        const selectedIds = Array.from(selectedItems).map(item => item.getAttribute('data-card-id'));
                        
                        // 添加到文件夹
                        if (selectedIds.length > 0) {
                            addMaterialsToFolder(targetFolderId, selectedIds);
                        }
                        
                        // 关闭模态窗口
                        addToFolderModal.classList.remove('active');
                    });
                }
                
                // 显示模态窗口
                addToFolderModal.classList.add('active');
            }

            // 添加素材到文件夹
            function addMaterialsToFolder(folderId, cardIds) {
                // 实际应用中，这里应该调用API保存关系
                console.log(`Adding materials ${cardIds.join(', ')} to folder ${folderId}`);
                
                // 刷新文件夹内容
                showFolderContents(folderId);
                
                // 显示操作成功提示
                showNotification(`已将${cardIds.length}个素材添加到文件夹`);
            }

            // 显示通知提示
            function showNotification(message) {
                // 检查通知组件是否已存在
                let notification = document.getElementById('notification');
                
                if (!notification) {
                    notification = document.createElement('div');
                    notification.id = 'notification';
                    notification.className = 'notification';
                    document.body.appendChild(notification);
                }
                
                // 设置通知内容
                notification.textContent = message;
                notification.classList.add('active');
                
                // 自动关闭
                setTimeout(() => {
                    notification.classList.remove('active');
                }, 3000);
            }

            // 为批量操作添加"加入文件夹"功能
            if (addToFolderBtn) {
                addToFolderBtn.addEventListener('click', function() {
                    // 显示文件夹选择模态框
                    showFolderSelectionModal();
                });
            }

            // 显示文件夹选择模态框
            function showFolderSelectionModal() {
                // 检查是否有选中的素材
                const selectedCards = document.querySelectorAll('.material-card.selected');
                if (selectedCards.length === 0) {
                    showNotification('请先选择要添加到文件夹的素材');
                    return;
                }
                
                // 检查模态窗口是否已存在
                let folderSelectionModal = document.getElementById('folder-selection-modal');
                
                if (!folderSelectionModal) {
                    // 创建模态窗口
                    folderSelectionModal = document.createElement('div');
                    folderSelectionModal.id = 'folder-selection-modal';
                    folderSelectionModal.className = 'modal-overlay';
                    
                    folderSelectionModal.innerHTML = `
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">选择文件夹</h3>
                                <button class="modal-close" id="close-folder-selection">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p class="modal-instruction">将选中的素材添加到以下文件夹：</p>
                                
                                <div class="folder-list">
                                    <!-- 动态填充文件夹列表 -->
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-outline" id="cancel-folder-selection">取消</button>
                                <button class="btn btn-primary" id="confirm-folder-selection" disabled>添加到文件夹</button>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(folderSelectionModal);
                    
                    // 填充文件夹列表
                    const folderList = folderSelectionModal.querySelector('.folder-list');
                    const folderItems = document.querySelectorAll('.folder-item');
                    
                    folderItems.forEach(folder => {
                        const folderId = folder.getAttribute('data-folder-id');
                        const folderName = folder.querySelector('.sidebar-link').textContent.trim();
                        
                        const folderOption = document.createElement('div');
                        folderOption.className = 'folder-option';
                        folderOption.setAttribute('data-folder-id', folderId);
                        folderOption.innerHTML = `
                            <input type="radio" name="target-folder" id="folder-${folderId}" value="${folderId}">
                            <label for="folder-${folderId}">
                                <i class="fas fa-folder"></i>
                                <span>${folderName}</span>
                            </label>
                        `;
                        
                        folderList.appendChild(folderOption);
                        
                        // 添加点击事件（整行可点击）
                        folderOption.addEventListener('click', function() {
                            const radio = this.querySelector('input[type="radio"]');
                            radio.checked = true;
                            
                            // 启用确认按钮
                            document.getElementById('confirm-folder-selection').disabled = false;
                        });
                    });
                    
                    // 添加事件监听
                    const closeBtn = document.getElementById('close-folder-selection');
                    const cancelBtn = document.getElementById('cancel-folder-selection');
                    const confirmBtn = document.getElementById('confirm-folder-selection');
                    
                    closeBtn.addEventListener('click', () => {
                        folderSelectionModal.classList.remove('active');
                    });
                    
                    cancelBtn.addEventListener('click', () => {
                        folderSelectionModal.classList.remove('active');
                    });
                    
                    confirmBtn.addEventListener('click', () => {
                        // 获取选中的文件夹
                        const selectedFolder = folderSelectionModal.querySelector('input[name="target-folder"]:checked');
                        
                        if (selectedFolder) {
                            const folderId = selectedFolder.value;
                            
                            // 获取选中的素材ID
                            const selectedIds = Array.from(document.querySelectorAll('.material-card.selected'))
                                .map(card => card.getAttribute('data-card-id'));
                            
                            // 添加到文件夹
                            if (selectedIds.length > 0) {
                                addMaterialsToFolder(folderId, selectedIds);
                            }
                        }
                        
                        // 关闭模态窗口
                        folderSelectionModal.classList.remove('active');
                    });
                } else {
                    // 重置选中状态
                    const radios = folderSelectionModal.querySelectorAll('input[type="radio"]');
                    radios.forEach(radio => {
                        radio.checked = false;
                    });
                    
                    // 禁用确认按钮
                    document.getElementById('confirm-folder-selection').disabled = true;
                }
                
                // 显示模态窗口
                folderSelectionModal.classList.add('active');
            }
        });

        // 在document.addEventListener('DOMContentLoaded', function() { 内部添加上传素材分类的交互逻辑

        // 上传素材的品牌和类型分类交互
        document.addEventListener('click', function(e) {
            // 上传方法切换
            if (e.target.closest('.upload-method')) {
                const method = e.target.closest('.upload-method');
                const methodType = method.getAttribute('data-method');
                
                // 切换激活态
                document.querySelectorAll('.upload-method').forEach(m => m.classList.remove('active'));
                method.classList.add('active');
                
                // 切换内容区域
                document.querySelectorAll('.upload-content').forEach(c => c.classList.remove('active'));
                document.getElementById(`${methodType}-upload-content`)?.classList.add('active');
            }
            
            // 文件选择按钮点击
            if (e.target.closest('#select-file-btn')) {
                document.getElementById('file-input')?.click();
            }
            
            // 清除文件按钮点击
            if (e.target.closest('#clear-files')) {
                clearSelectedFiles();
            }
            
            // 取消上传按钮点击
            if (e.target.closest('#cancel-upload')) {
                document.getElementById('upload-popover')?.classList.remove('active');
            }
            
            // 关闭上传弹窗按钮点击
            if (e.target.closest('#close-upload-popover')) {
                document.getElementById('upload-popover')?.classList.remove('active');
            }
            
            // 确认上传按钮点击
            if (e.target.closest('#confirm-upload')) {
                handleMaterialUpload();
            }
            
            // 打开上传弹窗按钮点击
            if (e.target.closest('#upload-btn')) {
                document.getElementById('upload-popover')?.classList.add('active');
            }
            
            // 素材创建选项点击
            if (e.target.closest('.create-option')) {
                document.querySelectorAll('.create-option').forEach(option => {
                    option.classList.remove('selected');
                });
                e.target.closest('.create-option').classList.add('selected');
            }
        });

        // 文件拖放处理
        const uploadDropzone = document.getElementById('upload-dropzone');
        if (uploadDropzone) {
            uploadDropzone.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });
            
            uploadDropzone.addEventListener('dragleave', function() {
                this.classList.remove('dragover');
            });
            
            uploadDropzone.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                
                if (e.dataTransfer.files.length > 0) {
                    handleFiles(e.dataTransfer.files);
                }
            });
        }

        // 文件选择处理
        const fileInput = document.getElementById('file-input');
        if (fileInput) {
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    handleFiles(this.files);
                }
            });
        }

        // 标签输入处理
        const tagInput = document.getElementById('tag-input');
        const tagChips = document.getElementById('tag-chips');
        if (tagInput && tagChips) {
            tagInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && this.value.trim()) {
                    e.preventDefault();
                    addTag(this.value.trim());
                    this.value = '';
                }
            });
        }

        // 处理文件函数
        function handleFiles(files) {
            const selectedFiles = document.getElementById('selected-files');
            const fileList = document.getElementById('file-list');
            
            if (selectedFiles && fileList) {
                selectedFiles.style.display = 'block';
                
                // 清空文件列表
                fileList.innerHTML = '';
                
                for (let i = 0; i < files.length; i++) {
                    addFileToList(files[i]);
                }
                
                // 智能检测文件类型并设置相应的素材类型
                detectAndSetMaterialType(files);
            }
        }

        // 添加文件到列表
        function addFileToList(file) {
            const fileList = document.getElementById('file-list');
            if (!fileList) return;
            
            const fileItem = document.createElement('li');
            fileItem.className = 'file-item';
            
            // 获取文件类型图标
            let fileIconClass = 'fa-file';
            if (file.type.startsWith('image/')) {
                fileIconClass = 'fa-file-image';
            } else if (file.type === 'application/pdf') {
                fileIconClass = 'fa-file-pdf';
            } else if (file.type.includes('word')) {
                fileIconClass = 'fa-file-word';
            }
            
            // 格式化文件大小
            const fileSize = formatFileSize(file.size);
            
            fileItem.innerHTML = `
                <div class="file-icon">
                    <i class="fas ${fileIconClass}"></i>
                </div>
                <div class="file-info">
                    <div class="file-name">${file.name}</div>
                    <div class="file-size">${fileSize}</div>
                </div>
                <button class="file-remove">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            fileList.appendChild(fileItem);
            
            // 为文件名自动设置素材名称
            autoSetMaterialName(file.name);
            
            // 绑定移除按钮事件
            const removeBtn = fileItem.querySelector('.file-remove');
            if (removeBtn) {
                removeBtn.addEventListener('click', function() {
                    fileItem.remove();
                    
                    // 如果列表为空，隐藏文件列表区域
                    if (fileList.children.length === 0) {
                        document.getElementById('selected-files').style.display = 'none';
                    }
                });
            }
        }

        // 根据上传的文件名自动设置素材名称
        function autoSetMaterialName(fileName) {
            const materialNameInput = document.getElementById('material-name');
            if (materialNameInput && !materialNameInput.value) {
                // 去除扩展名和特殊字符
                const nameWithoutExt = fileName.split('.').slice(0, -1).join('.');
                const cleanName = nameWithoutExt.replace(/[_\-\.]/g, ' ').replace(/\s+/g, ' ').trim();
                
                // 转换为标题格式（首字母大写）
                const titleCaseName = cleanName.replace(/\w\S*/g, function(txt) {
                    return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
                });
                
                materialNameInput.value = titleCaseName;
            }
        }

        // 智能检测文件类型并设置素材类型
        function detectAndSetMaterialType(files) {
            if (files.length === 0) return;
            
            // 简单的启发式检测
            const fileNames = Array.from(files).map(file => file.name.toLowerCase());
            const fileName = fileNames[0];
            
            // 设置对应的素材类型单选按钮
            if (fileName.includes('icon') || fileName.includes('图标')) {
                document.getElementById('type-icon').checked = true;
            } else if (fileName.includes('background') || fileName.includes('bg') || fileName.includes('背景')) {
                document.getElementById('type-background').checked = true;
            } else if (fileName.includes('logo') || fileName.includes('标志')) {
                document.getElementById('type-icon').checked = true;
            } else if (fileName.includes('graphic') || fileName.includes('图形')) {
                document.getElementById('type-graphic').checked = true;
            } else if (fileName.includes('product') || fileName.includes('产品')) {
                document.getElementById('type-product').checked = true;
            }
            
            // 检测品牌关键字
            if (fileName.includes('anxiuze') || fileName.includes('安修泽')) {
                document.getElementById('brand-anxiuze').checked = true;
            } else if (fileName.includes('qichu') || fileName.includes('且初')) {
                document.getElementById('brand-qichu').checked = true;
            } else if (fileName.includes('ddg')) {
                document.getElementById('brand-ddg').checked = true;
            }
            
            // 根据文件名提取潜在标签
            extractTagsFromFileName(fileName);
        }

        // 从文件名提取潜在标签
        function extractTagsFromFileName(fileName) {
            // 移除扩展名
            const nameWithoutExt = fileName.split('.').slice(0, -1).join('.');
            
            // 将文件名按常见分隔符分割
            const parts = nameWithoutExt.split(/[-_\s]/).filter(p => p.length > 2);
            
            // 检查是否有可能的标签
            parts.forEach(part => {
                if (!part.match(/^(image|img|pic|photo|file|temp|new|[0-9]+)$/i)) {
                    // 排除一些常见的无意义词汇
                    addTag(part);
                }
            });
        }

        // 添加标签
        function addTag(tagText) {
            const tagChips = document.getElementById('tag-chips');
            if (!tagChips) return;
            
            // 检查标签是否已存在
            const existingTags = Array.from(tagChips.querySelectorAll('.tag-chip')).map(chip => {
                return chip.textContent.trim().replace(/\s*×\s*$/, '');
            });
            
            if (!existingTags.includes(tagText)) {
                const tagChip = document.createElement('div');
                tagChip.className = 'tag-chip';
                tagChip.innerHTML = `${tagText} <i class="fas fa-times"></i>`;
                
                tagChips.appendChild(tagChip);
                
                // 绑定删除标签事件
                const removeIcon = tagChip.querySelector('i');
                if (removeIcon) {
                    removeIcon.addEventListener('click', function() {
                        tagChip.remove();
                    });
                }
            }
        }

        // 清除选择的文件
        function clearSelectedFiles() {
            const fileList = document.getElementById('file-list');
            const selectedFiles = document.getElementById('selected-files');
            const fileInput = document.getElementById('file-input');
            
            if (fileList) fileList.innerHTML = '';
            if (selectedFiles) selectedFiles.style.display = 'none';
            if (fileInput) fileInput.value = '';
        }

        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // 处理素材上传
        function handleMaterialUpload() {
            // 获取表单值
            const materialName = document.getElementById('material-name')?.value || '';
            const materialType = document.querySelector('input[name="material-type"]:checked')?.value || '';
            const brand = document.querySelector('input[name="brand"]:checked')?.value || '';
            const folder = document.getElementById('folder-select')?.value || '';
            
            // 收集标签
            const tags = [];
            document.querySelectorAll('#tag-chips .tag-chip').forEach(chip => {
                tags.push(chip.textContent.trim().replace(/\s*×\s*$/, ''));
            });
            
            // 检查必填字段
            if (!materialName) {
                showToast('请输入素材名称');
                    return;
                }
                
            // 获取已选文件（如果有）
            const files = document.getElementById('file-input')?.files || [];
            if (files.length === 0 && document.querySelector('.upload-method.active').getAttribute('data-method') === 'local') {
                showToast('请选择要上传的文件');
                return;
            }
            
            // 模拟上传进度
            showUploadProgress();
            
            // 模拟上传完成
            setTimeout(() => {
                // 关闭上传弹窗
                document.getElementById('upload-popover').classList.remove('active');
                
                // 清空表单
                clearUploadForm();
                
                // 显示成功提示
                showToast('素材上传成功');
                
                // 模拟添加素材到网格
                addMaterialToGrid({
                    name: materialName,
                    type: materialType,
                    brand: brand,
                    tags: tags
                });
            }, 1500);
        }

        // 清空上传表单
        function clearUploadForm() {
            if (document.getElementById('material-name')) document.getElementById('material-name').value = '';
            if (document.getElementById('type-product')) document.getElementById('type-product').checked = true;
            if (document.getElementById('brand-anxiuze')) document.getElementById('brand-anxiuze').checked = true;
            if (document.getElementById('folder-select')) document.getElementById('folder-select').value = '';
            if (document.getElementById('tag-chips')) document.getElementById('tag-chips').innerHTML = '';
            clearSelectedFiles();
        }

        // 显示上传进度
        function showUploadProgress() {
            // 创建进度条元素
            const progressContainer = document.createElement('div');
            progressContainer.className = 'upload-progress-container';
            progressContainer.innerHTML = `
                <div class="upload-progress-text">正在上传...</div>
                <div class="upload-progress-bar">
                    <div class="upload-progress-fill"></div>
                            </div>
            `;
            
            // 添加到上传弹窗
            const popoverFooter = document.querySelector('#upload-popover .filter-popover-footer');
            if (popoverFooter) {
                popoverFooter.insertAdjacentElement('beforebegin', progressContainer);
                
                // 禁用按钮
                const buttons = popoverFooter.querySelectorAll('button');
                buttons.forEach(btn => btn.disabled = true);
                
                // 动画进度条
                const progressFill = progressContainer.querySelector('.upload-progress-fill');
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 5;
                    progressFill.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        progressContainer.querySelector('.upload-progress-text').textContent = '上传完成';
                        
                        // 短暂延迟后移除进度条并恢复按钮
                        setTimeout(() => {
                            progressContainer.remove();
                            buttons.forEach(btn => btn.disabled = false);
                        }, 500);
                    }
                }, 75);
            }
        }

        // 显示提示信息
        function showToast(message) {
            // 检查通知组件是否已存在
            let notification = document.getElementById('notification');
            
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'notification';
                notification.className = 'notification';
                document.body.appendChild(notification);
            }
            
            // 设置通知内容
            notification.textContent = message;
            notification.classList.add('active');
            
            // 自动关闭
            setTimeout(() => {
                notification.classList.remove('active');
            }, 3000);
        }

        // 模拟添加素材到网格
        function addMaterialToGrid(material) {
            const materialsGrid = document.querySelector('.materials-grid');
            if (!materialsGrid) return;
            
            // 获取占位素材卡片
            const createNewMaterial = document.querySelector('.create-new-material');
            
            // 创建新素材卡片
            const materialCard = document.createElement('div');
            materialCard.className = 'material-card';
            materialCard.setAttribute('data-card-id', `card${Date.now()}`);
            
            // 获取类型标签文本
            let typeText = '其他';
            switch (material.type) {
                case 'product': typeText = '图片'; break;
                case 'icon': typeText = '图标'; break;
                case 'background': typeText = '背景'; break;
                case 'graphic': typeText = '图形'; break;
            }
            
            // 获取品牌标签文本
            let brandText = '';
            let brandClass = '';
            switch (material.brand) {
                case 'anxiuze': 
                    brandText = '安修泽'; 
                    brandClass = 'kimtrue-card';
                    break;
                case 'qichu': 
                    brandText = '且初'; 
                    break;
                case 'ddg': 
                    brandText = 'ddg'; 
                    break;
            }
            
            // 设置卡片内容
            materialCard.innerHTML = `
                <div class="material-thumbnail">
                    <img src="https://source.unsplash.com/random/400x300?${typeText}" alt="${material.name}">
                    <div class="material-tags">
                        ${brandText ? `<span class="brand-tag">${brandText}</span>` : ''}
                        <span class="material-type">${typeText}</span>
                                </div>
                </div>
                <div class="material-info">
                    <div class="material-title">${material.name}</div>
                    <div class="material-meta">
                        <span>1200 x 800px</span>
                        <span>${new Date().toLocaleDateString()}</span>
                    </div>
                </div>
                <div class="material-actions">
                    <button class="action-btn" title="编辑"><i class="fas fa-pencil-alt"></i></button>
                    <button class="action-btn" title="下载"><i class="fas fa-download"></i></button>
                    <button class="action-btn" title="更多操作"><i class="fas fa-ellipsis-h"></i></button>
                </div>
            `;
            
            // 添加品牌类
            if (brandClass) {
                materialCard.classList.add(brandClass);
            }
            
            // 添加动画效果
            materialCard.style.animation = 'none';
            
            // 添加到网格（在"添加新素材"卡片前）
            if (createNewMaterial) {
                materialsGrid.insertBefore(materialCard, createNewMaterial);
            } else {
                materialsGrid.appendChild(materialCard);
            }
            
            // 触发重绘并添加动画
            void materialCard.offsetWidth;
            materialCard.style.animation = 'fadeIn 0.5s ease-out';
        }
    </script>
</body>
</html>
